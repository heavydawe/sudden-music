{"version":3,"sources":["AppComponents/Actions/index.tsx","AppComponents/ArrangementView/ArrangementViewComponents/NewTrackModal.tsx","AppComponents/ArrangementView/ArrangementViewComponents/Track.tsx","AppComponents/ArrangementView/ArrangementViewComponents/TrackFunctions.tsx","AppComponents/Icons/trackName.png","AppComponents/Icons/trackInstrument.png","AppComponents/Icons/editButton.png","AppComponents/Icons/deleteButton.png","AppComponents/GetPositionFunctions.tsx","AppComponents/ArrangementView/ArrangementViewComponents/MidiClip.tsx","AppComponents/ArrangementView/ArrangementViewComponents/ArrangementCanvas.tsx","AppComponents/Icons/powerOnButton.png","AppComponents/Icons/powerOffButton.png","AppComponents/ArrangementView/ArrangementViewComponents/AudioSampler.tsx","AppComponents/Samples/Kick.wav","AppComponents/Samples/OpenHihat.wav","AppComponents/ArrangementView/ArrangementViewComponents/AudioSampleImport.tsx","AppComponents/Samples/Clap.wav","AppComponents/Samples/Ride.wav","AppComponents/Samples/Crash.wav","AppComponents/ArrangementView/ArrangementView.tsx","AppComponents/Icons/addButton.png","AppComponents/firebase.tsx","AppComponents/Footer/Footer.tsx","AppComponents/Header/Header.tsx","AppComponents/Icons/playButton.png","AppComponents/NavigationBar/NavigationBar.tsx","AppComponents/Icons/stopButton.png","AppComponents/Icons/pauseButton.png","AppComponents/PianoRollView/PianoRollViewComponents/PianoTiles.tsx","AppComponents/PianoRollView/PianoRollViewComponents/Note.tsx","AppComponents/PianoRollView/PianoRollViewComponents/PianoRollCanvas.tsx","AppComponents/PianoRollView/PianoRollView.tsx","App.tsx","reportWebVitals.ts","AppComponents/Reducers/CurTracksReducer.tsx","AppComponents/Reducers/SelectedMidiClipReducer.tsx","AppComponents/Reducers/ArrCanvasPropsReducer.tsx","AppComponents/Reducers/PianoRollCanvasPropsReducer.tsx","AppComponents/Reducers/CurTransportPositionReducer.tsx","AppComponents/Reducers/ClearTrackReducer.tsx","AppComponents/Reducers/ImportPropsReducer.tsx","AppComponents/Reducers/index.tsx","index.tsx"],"names":["updateMidiClip","modifyMidiClip","type","trackIndex","trackDataKey","updateNote","modifyNote","changeMidiClipColor","newColor","payload","changeMidiNoteColor","NewTrackModal","props","newTrackNameRef","useRef","newTrackInstrumentRef","dispatch","useDispatch","isOpen","showModal","className","appElement","document","getElementById","id","autoComplete","maxLength","minLength","required","ref","defaultValue","instrument","disabled","value","onClick","setShowModal","trackKey","newTrackProps","current","validity","valueMissing","alert","length","mode","modifyTrack","dataKey","midiClips","name","isMuted","Track","React","memo","useState","curInstrument","setCurInstrument","isEditOpen","setIsEditOpen","curParts","setCurParts","useEffect","instrumentName","Tone","toDestination","Error","getInstrument","newPartNotes","forEach","midiClipMap","newNoteMap","part","clear","partNotes","noteMap","push","key","time","note","notePartObject","add","isDisposed","dispose","undefined","newCurParts","map","midiClip","newPart","triggerAttackRelease","start","startTime","notes","notePart","curNoteToModify","stateIndex","findIndex","midiClipDataKey","newNote","newNoteProps","prevState","slice","noteToDeleteIndex","noteDataKey","remove","noteToUpdateIndex","updatedNote","curMidiClipToModify","newMidiClipProps","midiClipToDeleteIndex","midiClipToUpdateIndex","newNotes","src","alt","trackName","window","confirm","getPositionX","curX","width","canvasWidth","blockSnapSize","useFloor","Math","floor","round","getPositionY","curY","canvasHeight","trackOrTileHeight","MidiClip","canvasProps","trackHeight","gridPadding","midiClipRef","trRefMidi","isSelected","nodes","getLayer","batchDraw","x","shapeProps","posX","y","posY","height","stroke","strokeWidth","cornerRadius","fill","color","draggable","onDragStart","e","evt","button","handleSelect","onDragEnd","target","position","changePos","onTransformEnd","scaleAmmount","scaleX","newSize","changeSize","enabledAnchors","rotateEnabled","borderStroke","anchorCornerRadius","anchorFill","anchorStrokeWidth","resizeEnabled","boundBoxFunc","oldBox","newBox","stopTransform","getMidiClipStartTime","blockSnapSizeToTick","getMidiClipTrackKey","getMidiClipFromRect","midiClipRect","midiClipNotes","ArrangementCanvas","numOfTracks","numOfPhrases","useSelector","state","arrCanvasProps","midiClipColor","curPositionRef","curPositionLayer","innerWidth","midiKeyGenerator","setMidiKeyGenerator","selectedMidiClipId","selectMidiClipId","midiClipPos","isImported","midiClipsPos","max","apply","curMidiClipsRect","initMidiClipRects","gridLines","i","points","darkMeasureRects","opacity","loop","loopEnd","scheduleRepeat","schedule","trunc","progress","draw","curPositionRect","fillLinearGradientStartPoint","fillLinearGradientEndPoint","fillLinearGradientColorStops","onMouseDown","preventDefault","getStage","getAttr","transform","currentTarget","getAbsoluteTransform","copy","invert","pos","getPointerPosition","point","onDblClick","newMidi","onContextMenu","midiClipToDeleteDataKey","find","item","isDragging","newMidiClip","newPosX","newPosY","prevTrackKey","AudioSampler","isOn","setIsOn","curEvent","setCurEvent","powerButtonRef","context","AudioContext","fetch","sampleProps","samplePath","then","response","arrayBuffer","decodeAudioData","audioBuffer","sampler","urls","C4","onload","eventID","sampleRepeatTime","sampleStartTime","catch","error","console","log","sampleName","powerOffButton","powerOnButton","handlePowerButton","samplePaths","Kick","OpenHihat","ArrangementView","curTrackInfos","curTracks","disposeTracks","tracks","modifiedNote","modifiedMidiClip","flatMap","track","path","app","firebase","initializeApp","apiKey","process","authDomain","projectId","storageBucket","messagingSenderId","appId","appStore","firestore","appAuth","auth","Footer","currentUser","isLoggedIn","setIsLoggedIn","isPrefOpen","setIsPrefOpen","isSignUpOpen","setIsSignUpOpen","isSignInOpen","setIsSignInOpen","emailRef","passwordRef","passwordConfirmRef","signInEmailRef","signInPasswordRef","prefThemeRef","prefMidiClipColor","prefMidiNoteColor","signOut","root","documentElement","style","setProperty","collection","doc","uid","set","theme","midiNoteColor","signInWithEmailAndPassword","cred","user","get","data","code","match","tooShort","checkSignUpCredentials","createUserWithEmailAndPassword","message","fileSelector","createElement","accept","onchange","files","file","fileReader","FileReader","endsWith","onloadend","content","result","fileParts","toString","split","importedBPM","isNaN","projectToImport","parsedJSON","JSON","parse","every","isValidProject","importedJSON","readAsText","click","Header","togglePlay","buttonRef","curTransportPosition","playButton","stop","changeBPM","BPMInputRef","test","newBPMValue","bpm","NavigationBar","importedProps","BPM","playStopButtonRef","pause","min","onKeyUp","onBlur","onChange","initPianoTile","pianoTiles","octave","tileColor","unshift","title","PianoTiles","Note","tileHeight","noteRef","trRefNote","onMouseOver","setAttrs","onMouseLeave","getNoteName","tileID","getNoteStartTime","offset","getNoteDuration","getNoteInfo","noteName","noteDuration","getNotePosY","octaveOffset","getNotePosX","getNoteWidth","PianoRollCanvas","numOfBeats","pianoRollCanvasProps","curNotesRect","initedNotes","initNotes","keyGenerator","setKeyGenerator","selectedNoteId","selectNoteId","gridLayerComponents","checkDeselect","newNoteInfo","curDataKey","noteToUpdateInfo","PianoRollView","selectedMidiClip","curPianoRollGridPadding","setCurPianoRollGridPadding","selectedMidiClipInfo","scrollIntoView","behavior","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","midiClipOrNoteCollideScenarioOne","newMidiClipOrNoteStartTime","otherMidiClipOrNoteStartTime","otherMidiClipOrNoteEndTime","midiClipOrNoteCollideScenarioTwo","newMidiClipOrNoteEndTime","midiClipOrNoteCollideScenarioThree","isMidiClipColliding","otherMidiClips","newMidiClipStartTime","newMidiClipEndTime","some","otherMidiClip","otherMidiClipStartTime","otherMidiClipEndTime","isMidiNoteColliding","newMidiNote","otherMidiNotes","newMidiNoteStartTime","newMidiNoteEndTime","otherMidiNote","otherMidiNoteStartTime","otherMidiNoteEndTime","isAllowed","CurTracksReducer","action","element","Blob","stringify","href","URL","createObjectURL","download","maxDataKey","trackToDeleteIndex","trackToChangeIndex","hasInstrumentChanged","addedMidis","updatedMidiClip","prevInstrument","newInstrument","newTracks","midiClipToCopy","oldTrackInstrumentName","midiClipIndexAdd","addedNotesMidiClip","midiClipIndexDelete","deletedNotesMidiClip","midiClipIndexUpdate","updatedNotesMidiClip","SelectedMidiClipReducer","ArrCanvasPropsReducer","PianoRollCanvasPropsReducer","CurTransportPositionReducer","onkeydown","ClearTrackReducer","ImportPropsReducer","allReducers","combineReducers","store","createStore","allReducer","PPQ","ReactDOM","render"],"mappings":"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","file":"static/js/main.6005d601.chunk.js","sourcesContent":["import {\r\n  ModifyMidiClip,\r\n  ModifyNote,\r\n  TrackInterface,\r\n  TrackProps,\r\n} from \"../Interfaces\";\r\n\r\nexport const addNewTrack = (newTrack: TrackInterface) => {\r\n  return {\r\n    type: \"ADD_NEW_TRACK\",\r\n    modifyTrack: newTrack,\r\n  };\r\n};\r\n\r\nexport const deleteTrack = (trackToDeleteDataKey: number) => {\r\n  return {\r\n    type: \"DELETE_TRACK\",\r\n    trackIndex: trackToDeleteDataKey,\r\n  };\r\n};\r\n\r\nexport const changeTrackProps = (\r\n  trackKey: number,\r\n  newTrackProps: TrackProps\r\n) => {\r\n  return {\r\n    type: \"CHANGE_TRACK_PROPS\",\r\n    trackIndex: trackKey,\r\n    newTrackProps: newTrackProps,\r\n  };\r\n};\r\n\r\nexport const clearModifyNote = () => {\r\n  return {\r\n    type: \"CLEAR_MODIFY_NOTE\",\r\n  };\r\n};\r\n\r\nexport const clearModifyMidiclip = () => {\r\n  return {\r\n    type: \"CLEAR_MODIFY_MIDICLIP\",\r\n  };\r\n};\r\n\r\nexport const selectMidiClip = (trackKey: number, midiClipDataKey: number) => {\r\n  return {\r\n    type: \"SELECT_MIDI_CLIP\",\r\n    payload: {\r\n      trackKey: trackKey,\r\n      midiClipDataKey: midiClipDataKey,\r\n    },\r\n  };\r\n};\r\n\r\nexport const deselectMidiClip = () => {\r\n  return {\r\n    type: \"DESELECT_MIDI_CLIP\",\r\n  };\r\n};\r\n\r\nexport const addNewMidiClip = (modifyMidiClip: ModifyMidiClip) => {\r\n  return {\r\n    type: \"ADD_MIDI_CLIP\",\r\n    trackIndex: modifyMidiClip.trackDataKey,\r\n    modifyMidiClip: modifyMidiClip,\r\n  };\r\n};\r\n\r\nexport const deleteMidiClip = (modifyMidiClip: ModifyMidiClip) => {\r\n  return {\r\n    type: \"DELETE_MIDI_CLIP\",\r\n    trackIndex: modifyMidiClip.trackDataKey,\r\n    modifyMidiClip: modifyMidiClip,\r\n  };\r\n};\r\n\r\nexport const updateMidiClip = (modifyMidiClip: ModifyMidiClip) => {\r\n  return {\r\n    type: \"UPDATE_MIDI_CLIP\",\r\n    trackIndex: modifyMidiClip.trackDataKey,\r\n    modifyMidiClip: modifyMidiClip,\r\n  };\r\n};\r\n\r\nexport const addNewNote = (modifyNote: ModifyNote) => {\r\n  return {\r\n    type: \"ADD_NOTE\",\r\n    trackIndex: modifyNote.trackDataKey,\r\n    modifyNote: modifyNote,\r\n  };\r\n};\r\n\r\nexport const deleteNote = (modifyNote: ModifyNote) => {\r\n  return {\r\n    type: \"DELETE_NOTE\",\r\n    trackIndex: modifyNote.trackDataKey,\r\n    modifyNote: modifyNote,\r\n  };\r\n};\r\n\r\nexport const updateNote = (modifyNote: ModifyNote) => {\r\n  return {\r\n    type: \"UPDATE_NOTE\",\r\n    trackIndex: modifyNote.trackDataKey,\r\n    modifyNote: modifyNote,\r\n  };\r\n};\r\n\r\nexport const exportProject = () => {\r\n  return {\r\n    type: \"EXPORT_PROJECT\",\r\n  };\r\n};\r\n\r\nexport const importProject = (importedJSON: JSON) => {\r\n  return {\r\n    type: \"IMPORT_PROJECT\",\r\n    importedJSON: importedJSON,\r\n  };\r\n};\r\n\r\nexport const setImportedBPM = (newBPM: number) => {\r\n  return {\r\n    type: \"SET_IMPORTED_BPM\",\r\n    payload: newBPM,\r\n  };\r\n};\r\n\r\nexport const clearImportedBPM = () => {\r\n  return {\r\n    type: \"CLEAR_IMPORTED_BPM\",\r\n  };\r\n};\r\n\r\nexport const clearEveryTrack = () => {\r\n  return {\r\n    type: \"CLEAR_EVERY_TRACK\",\r\n  };\r\n};\r\n\r\nexport const tracksCleared = () => {\r\n  return {\r\n    type: \"TRACKS_CLEARED\",\r\n  };\r\n};\r\n\r\nexport const clearImportFlag = () => {\r\n  return {\r\n    type: \"CLEAR_IMPORT_FLAG\",\r\n  };\r\n};\r\n\r\nexport const changeArrViewNumOfPhrases = (newNumOfPhrases: number) => {\r\n  return {\r\n    type: \"CHANGE_ARR_VIEW_NUM_OF_PHRASES\",\r\n    payload: newNumOfPhrases,\r\n  };\r\n};\r\n\r\nexport const changeArrViewGridPadding = (newNumOfGridPadding: number) => {\r\n  return {\r\n    type: \"CHANGE_ARR_VIEW_GRID_PADDING\",\r\n    payload: newNumOfGridPadding,\r\n  };\r\n};\r\n\r\nexport const changeMidiClipColor = (newColor: string) => {\r\n  return {\r\n    type: \"CHANGE_MIDI_CLIP_COLOR\",\r\n    payload: newColor,\r\n  };\r\n};\r\n\r\nexport const changePianoRollViewGridPadding = (newNumOfGridPadding: number) => {\r\n  return {\r\n    type: \"CHANGE_PIANO_ROLL_VIEW_GRID_PADDING\",\r\n    payload: newNumOfGridPadding,\r\n  };\r\n};\r\n\r\nexport const changeMidiNoteColor = (newColor: string) => {\r\n  return {\r\n    type: \"CHANGE_MIDI_NOTE_COLOR\",\r\n    payload: newColor,\r\n  };\r\n};\r\n\r\nexport const changeTransportPosition = (newPosition: number) => {\r\n  return {\r\n    type: \"SET_CUR_TRANSPORT_POSITION\",\r\n    payload: newPosition,\r\n  };\r\n};\r\n","import { useRef } from \"react\";\r\nimport ReactModal from \"react-modal\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { addNewTrack, changeTrackProps } from \"../../Actions\";\r\nimport \"./NewTrackModal.css\";\r\n\r\ninterface Props {\r\n  showModal: boolean;\r\n  setShowModal: React.Dispatch<React.SetStateAction<boolean>>;\r\n  mode: string;\r\n  trackKey?: number;\r\n  instrument?: string;\r\n}\r\n\r\nfunction NewTrackModal(props: Props) {\r\n  const newTrackNameRef = useRef<HTMLInputElement>(null);\r\n  const newTrackInstrumentRef = useRef<HTMLSelectElement>(null);\r\n  // const newTrackColorRef = useRef<HTMLInputElement>(null);\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  return (\r\n    <ReactModal\r\n      isOpen={props.showModal}\r\n      className=\"newTrackModal\"\r\n      appElement={document.getElementById(\"App\")!}\r\n    >\r\n      <div className=\"newTrackModalContainer\">\r\n        <div>\r\n          <p>Név</p>\r\n          <p>Hangszer</p>\r\n          {/* <p>Szín</p> */}\r\n        </div>\r\n        <div>\r\n          <input\r\n            key=\"newTrackNameInput\"\r\n            id=\"newTrackNameInput\"\r\n            autoComplete=\"off\"\r\n            type=\"text\"\r\n            maxLength={20}\r\n            minLength={5}\r\n            required={true}\r\n            ref={newTrackNameRef}\r\n          />\r\n          <br />\r\n          <select\r\n            id=\"newTrackInstrumentSelect\"\r\n            key=\"newTrackInstrumentSelect\"\r\n            defaultValue={props.instrument ? props.instrument : \"PolySynth\"}\r\n            ref={newTrackInstrumentRef}\r\n            disabled={\r\n              props.instrument ? props.instrument === \"PolySynth\" : false\r\n            }\r\n          >\r\n            <option value=\"AMSynth\">AMSynth</option>\r\n            <option value=\"DuoSynth\">DuoSynth</option>\r\n            <option value=\"FMSynth\">FMSynth</option>\r\n            <option value=\"MembraneSynth\">MembraneSynth</option>\r\n            <option value=\"MetalSynth\">MetalSynth</option>\r\n            <option value=\"MonoSynth\">MonoSynth</option>\r\n            <option value=\"PluckSynth\">PluckSynth</option>\r\n            <option value=\"PolySynth\">PolySynth</option>\r\n            <option value=\"Synth\">Synth</option>\r\n          </select>\r\n          <br />\r\n          {/* <input\r\n            key=\"newTrackColor\"\r\n            id=\"newTrackColor\"\r\n            type=\"color\"\r\n            required={true}\r\n            ref={newTrackColorRef}\r\n          /> */}\r\n        </div>\r\n      </div>\r\n      <button\r\n        className=\"newTrackModalCancelButton\"\r\n        onClick={() => {\r\n          props.setShowModal(false);\r\n        }}\r\n      >\r\n        Mégsem\r\n      </button>\r\n      <button\r\n        className=\"newTrackModalAddButton\"\r\n        onClick={() => {\r\n          if (newTrackNameRef.current!.validity.valueMissing) {\r\n            alert(\"Kérlek adj az új sávnak nevet!\");\r\n            return;\r\n          }\r\n\r\n          if (newTrackNameRef.current!.value.length < 5) {\r\n            alert(\"Kérlek az új sávnak a neve legalább 5 karakter legyen!\");\r\n            return;\r\n          }\r\n\r\n          if (props.mode === \"add\") {\r\n            dispatch(\r\n              addNewTrack({\r\n                dataKey: -1,\r\n                midiClips: [],\r\n                // color: \"red\", // newTrackColorRef.current!.value\r\n                instrument: newTrackInstrumentRef.current!.value,\r\n                name: newTrackNameRef.current!.value,\r\n                isMuted: false,\r\n              })\r\n            );\r\n          } else {\r\n            dispatch(\r\n              changeTrackProps(props.trackKey!, {\r\n                name: newTrackNameRef.current!.value,\r\n                // color: newTrackColorRef.current!.value,\r\n                instrument: newTrackInstrumentRef.current!.value,\r\n              })\r\n            );\r\n          }\r\n          props.setShowModal(false);\r\n        }}\r\n      >\r\n        {props.mode === \"add\" ? \"Hozzáadás\" : \"Mentés\"}\r\n      </button>\r\n    </ReactModal>\r\n  );\r\n}\r\n\r\nexport default NewTrackModal;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport * as Tone from \"tone\";\r\nimport {\r\n  clearImportFlag,\r\n  clearModifyMidiclip,\r\n  clearModifyNote,\r\n  deleteTrack,\r\n  deselectMidiClip,\r\n} from \"../../Actions\";\r\nimport { MidiClip, ModifyMidiClip, ModifyNote } from \"../../Interfaces\";\r\nimport { getInstrument, Instrument } from \"./TrackFunctions\";\r\nimport \"./Track.css\";\r\nimport deleteButton from \"../../Icons/deleteButton.png\";\r\nimport editButton from \"../../Icons/editButton.png\";\r\nimport trackNameIcon from \"../../Icons/trackName.png\";\r\nimport trackInsturmentIcon from \"../../Icons/trackInstrument.png\";\r\nimport NewTrackModal from \"./NewTrackModal\";\r\n\r\ninterface NoteMap {\r\n  key: number;\r\n  value: NotePartObject;\r\n}\r\n\r\ninterface NotePartObject {\r\n  time: string;\r\n  note: string;\r\n  length: string;\r\n  instrument: Instrument;\r\n}\r\n\r\ninterface PartInterface {\r\n  part: Tone.Part;\r\n  partNotes: NoteMap[];\r\n}\r\n\r\ninterface MidiClipMap {\r\n  key: number;\r\n  length: number;\r\n  value: PartInterface;\r\n}\r\n\r\ninterface Props {\r\n  dataKey: number;\r\n  trackName: string;\r\n  isMuted: boolean;\r\n  isDisposed: boolean;\r\n  // trackColor: string;\r\n  instrumentName: string;\r\n  curNoteToModify: ModifyNote | null;\r\n  curMidiClipToModify: ModifyMidiClip | null;\r\n  midiClips: MidiClip[] | null; // only used when a project has been imported\r\n}\r\n\r\nconst Track = React.memo((props: Props) => {\r\n  const dispatch = useDispatch();\r\n\r\n  // Instrument should be created only once, and change when the user changes it\r\n  const [curInstrument, setCurInstrument] = useState<Instrument>();\r\n  const [isEditOpen, setIsEditOpen] = useState<boolean>(false);\r\n\r\n  // TODO: INIT correctly when importing\r\n  const [curParts, setCurParts] = useState<MidiClipMap[]>([]);\r\n  // console.log(`IN TRACK ${props.dataKey}`, curParts);\r\n\r\n  // Only change instrument when inited or on user change\r\n  useEffect(() => {\r\n    setCurInstrument(getInstrument(props.instrumentName));\r\n  }, [props.instrumentName]);\r\n\r\n  // Update every Parts, when the instrument has changed\r\n  useEffect(() => {\r\n    let newPartNotes: MidiClipMap[] = [];\r\n\r\n    // console.log(\"!!!!NEWINSTR\");\r\n\r\n    curParts.forEach((midiClipMap) => {\r\n      let newNoteMap: NoteMap[] = [];\r\n      midiClipMap.value.part.clear();\r\n\r\n      midiClipMap.value.partNotes.forEach((noteMap) =>\r\n        newNoteMap.push({\r\n          key: noteMap.key,\r\n          value: {\r\n            time: noteMap.value.time,\r\n            length: noteMap.value.length,\r\n            note: noteMap.value.note,\r\n            instrument: curInstrument!,\r\n          },\r\n        })\r\n      );\r\n\r\n      newNoteMap.forEach((notePartObject) =>\r\n        midiClipMap.value.part.add(notePartObject.value)\r\n      );\r\n\r\n      newPartNotes.push({\r\n        key: midiClipMap.key,\r\n        value: {\r\n          part: midiClipMap.value.part,\r\n          partNotes: newNoteMap,\r\n        },\r\n        length: midiClipMap.length,\r\n      });\r\n    });\r\n\r\n    setCurParts(newPartNotes);\r\n\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [curInstrument]);\r\n\r\n  // Mute all parts if track is muted\r\n  // TODO if midiclip switches track reducers needs to set mute correctly\r\n  // useEffect(() => {\r\n  //   curParts.forEach((midiClipMap) => {\r\n  //     midiClipMap.value.part.mute = props.isMuted;\r\n  //   })\r\n  // }, [props.isMuted])\r\n\r\n  //console.log(\"RENDERING IN TRACK, KEY:\", props.dataKey);\r\n\r\n  useEffect(() => {\r\n    if (!props.isDisposed) {\r\n      return;\r\n    }\r\n\r\n    curParts.forEach((midiClipMap) => midiClipMap.value.part.dispose());\r\n\r\n    // console.log(\"!!IN DISPOSED\");\r\n  }, [props.isDisposed, curParts]);\r\n\r\n  useEffect(() => {\r\n    if (curInstrument === undefined) {\r\n      return;\r\n    }\r\n\r\n    if (props.midiClips === null) {\r\n      return;\r\n    }\r\n\r\n    // Add everything to curParts\r\n    const newCurParts: MidiClipMap[] = props.midiClips.map((midiClip) => {\r\n      const newPart = new Tone.Part((time, value) => {\r\n        value.instrument.triggerAttackRelease(value.note, value.length, time);\r\n      }).start(`${midiClip.startTime}i`);\r\n\r\n      return {\r\n        key: midiClip.dataKey,\r\n        length: midiClip.length,\r\n        value: {\r\n          part: newPart,\r\n          partNotes: midiClip.notes.map((note) => {\r\n            const notePart: NotePartObject = {\r\n              note: note.note,\r\n              instrument: curInstrument,\r\n              length: `${note.length}i`,\r\n              time: `${note.startTime}i`,\r\n            };\r\n\r\n            newPart.add(notePart);\r\n\r\n            return {\r\n              key: note.dataKey,\r\n              value: notePart,\r\n            };\r\n          }),\r\n        },\r\n      };\r\n    });\r\n\r\n    // console.log(\"!!IN IMPORT EFFECT\");\r\n\r\n    setCurParts(newCurParts);\r\n    dispatch(clearImportFlag());\r\n  }, [props.midiClips, dispatch, curInstrument]);\r\n\r\n  useEffect(() => {\r\n    if (props.curNoteToModify === null) {\r\n      return;\r\n    }\r\n\r\n    // console.log(\"IN CURNOTEMODIFY\", props.curNoteToModify);\r\n\r\n    const stateIndex = curParts.findIndex(\r\n      (part) => part.key === props.curNoteToModify!.midiClipDataKey\r\n    );\r\n\r\n    switch (props.curNoteToModify.type) {\r\n      case \"ADD\":\r\n        // If instrument is not PolySynth, we need to check, if there is\r\n        // a note already in Part with the same startTime\r\n        // if (curInstrument!.name !== \"PolySynth\") {\r\n        //   const isAllowed = !curParts[stateIndex].value.partNotes.some(\r\n        //     (noteMap) =>\r\n        //       noteMap.value.time ===\r\n        //       `${props.curNoteToModify!.newNoteProps!.startTime}i`\r\n        //   );\r\n\r\n        //   if (!isAllowed) {\r\n        //     alert(\"Csak a PolySynth tud egyszerre több hangot is lejátszani!\");\r\n        //     dispatch(\r\n        //       deleteNote({\r\n        //         midiClipDataKey: props.curNoteToModify!.midiClipDataKey,\r\n        //         noteDataKey: props.curNoteToModify!.newNoteProps!.dataKey,\r\n        //         trackDataKey: props.dataKey,\r\n        //         type: \"DELETE\",\r\n        //       })\r\n        //     );\r\n        //     dispatch(clearModifyNote());\r\n        //     return;\r\n        //   }\r\n        // }\r\n\r\n        // console.log(\"ADDING NEW NOTE\");\r\n        const newNote: NotePartObject = {\r\n          time: `${props.curNoteToModify.newNoteProps!.startTime}i`,\r\n          note: props.curNoteToModify.newNoteProps!.note,\r\n          length: `${props.curNoteToModify.newNoteProps!.length}i`,\r\n          instrument: curInstrument!,\r\n        };\r\n\r\n        // THIS COULD BE PROBLEMATIC... or not..\r\n        curParts[stateIndex].value.part.add(newNote);\r\n\r\n        setCurParts((prevState) => [\r\n          ...prevState.slice(0, stateIndex),\r\n          {\r\n            ...prevState[stateIndex],\r\n            value: {\r\n              ...prevState[stateIndex].value,\r\n              partNotes: [\r\n                ...prevState[stateIndex].value.partNotes,\r\n                {\r\n                  key: props.curNoteToModify!.newNoteProps!.dataKey,\r\n                  value: newNote,\r\n                },\r\n              ],\r\n            },\r\n          },\r\n          ...prevState.slice(stateIndex + 1),\r\n        ]);\r\n        break;\r\n\r\n      case \"DELETE\":\r\n        // console.log(\"DELETING NOTE\");\r\n\r\n        const noteToDeleteIndex = curParts[\r\n          stateIndex\r\n        ].value.partNotes.findIndex(\r\n          (note) => note.key === props.curNoteToModify!.noteDataKey\r\n        );\r\n\r\n        // THIS COULD BE PROBLEMATIC.... or not...\r\n        curParts[stateIndex].value.part.remove(\r\n          curParts[stateIndex].value.partNotes[noteToDeleteIndex].value\r\n        );\r\n\r\n        setCurParts((prevState) => [\r\n          ...prevState.slice(0, stateIndex),\r\n          {\r\n            ...prevState[stateIndex],\r\n            value: {\r\n              ...prevState[stateIndex].value,\r\n              partNotes: [\r\n                ...prevState[stateIndex].value.partNotes.slice(\r\n                  0,\r\n                  noteToDeleteIndex\r\n                ),\r\n                ...prevState[stateIndex].value.partNotes.slice(\r\n                  noteToDeleteIndex + 1\r\n                ),\r\n              ],\r\n            },\r\n          },\r\n          ...prevState.slice(stateIndex + 1),\r\n        ]);\r\n\r\n        break;\r\n\r\n      case \"UPDATE\":\r\n        // console.log(\"UPDATING NOTE\");\r\n\r\n        const noteToUpdateIndex = curParts[\r\n          stateIndex\r\n        ].value.partNotes.findIndex(\r\n          (note) => note.key === props.curNoteToModify!.noteDataKey\r\n        );\r\n\r\n        // THIS COULD BE PROBLEMATIC....WORKS FINE!\r\n\r\n        curParts[stateIndex].value.part.remove(\r\n          curParts[stateIndex].value.partNotes[noteToUpdateIndex].value\r\n        );\r\n\r\n        const updatedNote: NotePartObject = {\r\n          time: `${props.curNoteToModify.newNoteProps!.startTime}i`,\r\n          note: props.curNoteToModify.newNoteProps!.note,\r\n          length: `${props.curNoteToModify.newNoteProps!.length}i`,\r\n          instrument: curInstrument!,\r\n        };\r\n\r\n        curParts[stateIndex].value.part.add(updatedNote);\r\n\r\n        setCurParts((prevState) => [\r\n          ...prevState.slice(0, stateIndex),\r\n          {\r\n            ...prevState[stateIndex],\r\n            value: {\r\n              ...prevState[stateIndex].value,\r\n              partNotes: [\r\n                ...prevState[stateIndex].value.partNotes.slice(\r\n                  0,\r\n                  noteToUpdateIndex\r\n                ),\r\n                {\r\n                  ...prevState[stateIndex].value.partNotes[noteToUpdateIndex],\r\n                  value: updatedNote,\r\n                },\r\n                ...prevState[stateIndex].value.partNotes.slice(\r\n                  noteToUpdateIndex + 1\r\n                ),\r\n              ],\r\n            },\r\n          },\r\n          ...prevState.slice(stateIndex + 1),\r\n        ]);\r\n\r\n        break;\r\n\r\n      default:\r\n        throw Error(\"Unknown curNoteToModify type!\");\r\n    }\r\n\r\n    dispatch(clearModifyNote());\r\n  }, [props.curNoteToModify, curParts, dispatch, curInstrument, props.dataKey]);\r\n\r\n  useEffect(() => {\r\n    if (props.curMidiClipToModify === null) {\r\n      return;\r\n    }\r\n\r\n    // console.log(\"IN CURMIDICLIPTOMODIFY\", props.curMidiClipToModify);\r\n\r\n    switch (props.curMidiClipToModify.type) {\r\n      case \"ADD\":\r\n        // console.log(\"ADDING NEW MIDICLIP\");\r\n        const newPart = new Tone.Part((time, value) => {\r\n          value.instrument.triggerAttackRelease(value.note, value.length, time);\r\n        }).start(`${props.curMidiClipToModify.newMidiClipProps!.startTime}i`);\r\n\r\n        setCurParts((prevState) => [\r\n          ...prevState,\r\n          {\r\n            key: props.curMidiClipToModify!.newMidiClipProps!.dataKey,\r\n            value: {\r\n              part: newPart,\r\n              partNotes: [],\r\n            },\r\n            length: props.curMidiClipToModify!.newMidiClipProps!.length,\r\n          },\r\n        ]);\r\n        break;\r\n\r\n      case \"DELETE\":\r\n        // console.log(\"DELETING MIDICLIP\");\r\n\r\n        // Find the index in state\r\n        const midiClipToDeleteIndex = curParts.findIndex(\r\n          (midiClip) =>\r\n            midiClip.key === props.curMidiClipToModify!.midiClipDataKey\r\n        );\r\n\r\n        // Remove all event from the Part (MIDI clip) and clear up\r\n        curParts[midiClipToDeleteIndex].value.part.dispose();\r\n\r\n        // Update state\r\n        setCurParts((prevState) => [\r\n          ...prevState.slice(0, midiClipToDeleteIndex),\r\n          ...prevState.slice(midiClipToDeleteIndex + 1),\r\n        ]);\r\n        break;\r\n\r\n      case \"UPDATE\":\r\n        // console.log(\"UPDATING MIDICLIP\");\r\n\r\n        // Find the index in state\r\n        const midiClipToUpdateIndex = curParts.findIndex(\r\n          (midiClip) =>\r\n            midiClip.key === props.curMidiClipToModify!.midiClipDataKey\r\n        );\r\n\r\n        if (\r\n          props.curMidiClipToModify.trackDataKey ===\r\n          props.curMidiClipToModify.newMidiClipProps!.trackKey\r\n        ) {\r\n          // MIDI clip did NOT switch track\r\n\r\n          // If size have changed, then we only need to update the length\r\n          // console.log(curParts[midiClipToUpdateIndex]);\r\n          if (\r\n            props.curMidiClipToModify!.newMidiClipProps!.length !==\r\n            curParts[midiClipToUpdateIndex].length\r\n          ) {\r\n            setCurParts((prevState) => [\r\n              ...prevState.slice(0, midiClipToUpdateIndex),\r\n              {\r\n                ...prevState[midiClipToUpdateIndex],\r\n                length: props.curMidiClipToModify!.newMidiClipProps!.length,\r\n              },\r\n              ...prevState.slice(midiClipToUpdateIndex + 1),\r\n            ]);\r\n            break;\r\n          }\r\n\r\n          // console.log(\"NEW START\");\r\n\r\n          // We have to create a new Part, as the start point cannot be changed\r\n          curParts[midiClipToUpdateIndex].value.part.dispose();\r\n\r\n          const newPart = new Tone.Part((time, value) => {\r\n            value.instrument.triggerAttackRelease(\r\n              value.note,\r\n              value.length,\r\n              time\r\n            );\r\n          }).start(`${props.curMidiClipToModify.newMidiClipProps!.startTime}i`);\r\n\r\n          // Add each note to newPart\r\n          curParts[midiClipToUpdateIndex].value.partNotes.forEach((note) =>\r\n            newPart.add(note.value)\r\n          );\r\n\r\n          // Update state\r\n          setCurParts((prevState) => [\r\n            ...prevState.slice(0, midiClipToUpdateIndex),\r\n            {\r\n              ...prevState[midiClipToUpdateIndex],\r\n              value: {\r\n                ...prevState[midiClipToUpdateIndex].value,\r\n                part: newPart,\r\n              },\r\n            },\r\n            ...prevState.slice(midiClipToUpdateIndex + 1),\r\n          ]);\r\n        } else {\r\n          // MIDI clip switched track\r\n          if (props.curMidiClipToModify.trackDataKey === props.dataKey) {\r\n            // This is the previous track, so we need to delete part from here\r\n            curParts[midiClipToUpdateIndex].value.part.dispose();\r\n\r\n            setCurParts((prevState) => [\r\n              ...prevState.slice(0, midiClipToUpdateIndex),\r\n              ...prevState.slice(midiClipToUpdateIndex + 1),\r\n            ]);\r\n          } else {\r\n            // This is the new track, so we need to insert it here\r\n            const newPart = new Tone.Part((time, value) => {\r\n              value.instrument.triggerAttackRelease(\r\n                value.note,\r\n                value.length,\r\n                time\r\n              );\r\n            }).start(\r\n              `${props.curMidiClipToModify.newMidiClipProps!.startTime}i`\r\n            );\r\n\r\n            // Get all notes from props\r\n            const newNotes =\r\n              props.curMidiClipToModify.newMidiClipProps!.notes.map((note) => {\r\n                return {\r\n                  key: note.dataKey,\r\n                  value: {\r\n                    time: `${note.startTime}i`,\r\n                    note: note.note,\r\n                    length: `${note.length}i`,\r\n                    instrument: curInstrument!,\r\n                  },\r\n                };\r\n              });\r\n\r\n            // Add notes to part\r\n            newNotes.forEach((note) => newPart.add(note.value));\r\n\r\n            // Update state, add everything\r\n            setCurParts((prevState) => [\r\n              ...prevState,\r\n              {\r\n                key: props.curMidiClipToModify!.newMidiClipProps!.dataKey,\r\n                value: {\r\n                  part: newPart,\r\n                  partNotes: newNotes,\r\n                },\r\n                length: props.curMidiClipToModify!.newMidiClipProps!.length,\r\n              },\r\n            ]);\r\n          }\r\n        }\r\n\r\n        break;\r\n\r\n      default:\r\n        throw Error(\"Unknown curMidiClipToModify type!\");\r\n    }\r\n\r\n    dispatch(clearModifyMidiclip());\r\n  }, [\r\n    props.curMidiClipToModify,\r\n    curInstrument,\r\n    dispatch,\r\n    curParts,\r\n    props.dataKey,\r\n  ]);\r\n\r\n  return (\r\n    <div className=\"trackHeader\">\r\n      <div className=\"trackHeaderContainer\">\r\n        <div>\r\n          <img\r\n            className=\"trackHeaderInstrumentNameImg\"\r\n            src={trackNameIcon}\r\n            alt=\"\"\r\n          />\r\n          <br />\r\n          <img\r\n            className=\"trackHeaderInstrumentNameImg\"\r\n            src={trackInsturmentIcon}\r\n            alt=\"\"\r\n          />\r\n        </div>\r\n        <div>\r\n          <span className=\"trackHeaderTitle\">{props.trackName}</span>\r\n          <br />\r\n          <span className=\"trackHeaderInstrumentName\">\r\n            {props.instrumentName}\r\n          </span>\r\n        </div>\r\n      </div>\r\n      <button\r\n        className=\"trackHeaderEditButton\"\r\n        onClick={() => setIsEditOpen(true)}\r\n      >\r\n        <img src={editButton} alt=\"Edit\" />\r\n      </button>\r\n      <button\r\n        className=\"trackHeaderDeleteButton\"\r\n        onClick={() => {\r\n          if (window.confirm(\"Biztosan törölni szeretnéd a sávot?\")) {\r\n            curParts.forEach((part) => part.value.part.dispose());\r\n            dispatch(deselectMidiClip());\r\n            dispatch(deleteTrack(props.dataKey));\r\n          }\r\n        }}\r\n      >\r\n        <img src={deleteButton} alt=\"X\" />\r\n      </button>\r\n      <NewTrackModal\r\n        showModal={isEditOpen}\r\n        setShowModal={setIsEditOpen}\r\n        mode=\"edit\"\r\n        trackKey={props.dataKey}\r\n        instrument={curInstrument && curInstrument!.name}\r\n      />\r\n    </div>\r\n  );\r\n});\r\n\r\nexport default Track;\r\n","import * as Tone from \"tone\";\r\n// import { MidiClip, ModifyNote, NoteEvent } from \"../../Interfaces\";\r\n\r\nexport type Instrument =\r\n  | Tone.AMSynth\r\n  | Tone.DuoSynth\r\n  | Tone.FMSynth\r\n  | Tone.MembraneSynth\r\n  | Tone.MetalSynth\r\n  | Tone.MonoSynth\r\n  //  | Tone.NoiseSynth // NoiseSynth-nél nem működik a triggerAttackRelease a szokásos módon, mert ugye ő nem fog kapni \"note\"-ot\r\n  | Tone.PluckSynth\r\n  | Tone.PolySynth\r\n  // | Tone.Sampler\r\n  | Tone.Synth;\r\n\r\nfunction getInstrument(instrumentName: string) {\r\n  // console.log(\"NEW INSTR\");\r\n\r\n  switch (instrumentName) {\r\n    case \"AMSynth\":\r\n      return new Tone.AMSynth().toDestination();\r\n    case \"DuoSynth\":\r\n      return new Tone.DuoSynth().toDestination();\r\n    case \"FMSynth\":\r\n      return new Tone.FMSynth().toDestination();\r\n    case \"MembraneSynth\":\r\n      return new Tone.MembraneSynth().toDestination();\r\n    case \"MetalSynth\":\r\n      return new Tone.MetalSynth().toDestination();\r\n    case \"MonoSynth\":\r\n      return new Tone.MonoSynth().toDestination();\r\n    case \"PluckSynth\":\r\n      return new Tone.PluckSynth().toDestination();\r\n    case \"PolySynth\":\r\n      return new Tone.PolySynth().toDestination();\r\n    case \"Synth\":\r\n      return new Tone.Synth().toDestination();\r\n\r\n    default:\r\n      throw new Error(\"Instrument's name is unknown!\");\r\n  }\r\n}\r\n\r\n// function updateCurEvents(\r\n//   modifiedNote: ModifyNote,\r\n//   midiClips: MidiClip[],\r\n//   instrument: Instrument,\r\n//   curEvents: NoteEvent[],\r\n//   setCurEvents: React.Dispatch<React.SetStateAction<NoteEvent[]>>\r\n// ) {\r\n//   switch (modifiedNote.type) {\r\n//     case \"ADD\":\r\n//       const eventID = Tone.Transport.schedule(() => {\r\n//         console.log(\"ADDING NOTE\");\r\n//         instrument.triggerAttackRelease(\r\n//           modifiedNote.newNoteProps!.note,\r\n//           `${modifiedNote.newNoteProps!.length}i`,\r\n//           `+${modifiedNote.newNoteProps!.startTime}i`\r\n//         );\r\n//       }, `${midiClips[modifiedNote.midiClipDataKey].startTime}i`);\r\n\r\n//       setCurEvents([\r\n//         ...curEvents,\r\n//         {\r\n//           eventID: eventID,\r\n//           midiClipDataKey: modifiedNote.midiClipDataKey,\r\n//           noteDataKey: modifiedNote.noteDataKey,\r\n//         },\r\n//       ]);\r\n//       return;\r\n\r\n//     case \"DELETE\":\r\n//       const noteEventToDeleteIndex = curEvents.findIndex(\r\n//         (noteEvent) => noteEvent.noteDataKey === modifiedNote.noteDataKey\r\n//       )!;\r\n\r\n//       Tone.Transport.clear(curEvents[noteEventToDeleteIndex].eventID);\r\n//       setCurEvents([\r\n//         ...curEvents.slice(0, noteEventToDeleteIndex),\r\n//         ...curEvents.slice(noteEventToDeleteIndex + 1),\r\n//       ]);\r\n//       return;\r\n\r\n//     case \"UPDATE\":\r\n//       return;\r\n\r\n//     default:\r\n//       throw new Error(\"Update type unknown\");\r\n//   }\r\n// }\r\n\r\nexport { getInstrument };\r\n","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAMTAAADEwE9ZoPHAAAFFmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDIgNzkuMTY0NDYwLCAyMDIwLzA1LzEyLTE2OjA0OjE3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMiAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIxLTA1LTAyVDE0OjU3OjE1KzAyOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMS0wNS0wMlQxNToxNjoyNyswMjowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMS0wNS0wMlQxNToxNjoyNyswMjowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpjNDFmNGViMS02ZGNiLTE5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\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAFFmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDIgNzkuMTY0NDYwLCAyMDIwLzA1LzEyLTE2OjA0OjE3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMiAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIxLTA0LTI0VDE2OjE1OjU4KzAyOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMS0wNC0yNFQxNjozMjo1MyswMjowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMS0wNC0yNFQxNjozMjo1MyswMjowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2NTY5ZDlkNi02ZDZhLThj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\"","function getPositionX(\r\n  curX: number,\r\n  width: number,\r\n  canvasWidth: number,\r\n  blockSnapSize: number,\r\n  useFloor: boolean\r\n) {\r\n  if (curX < 0) {\r\n    return 0;\r\n  }\r\n\r\n  if (curX + width > canvasWidth) {\r\n    return canvasWidth - width;\r\n  }\r\n\r\n  if (useFloor) {\r\n    return Math.floor(curX / blockSnapSize) * blockSnapSize;\r\n  } else {\r\n    return Math.round(curX / blockSnapSize) * blockSnapSize;\r\n  }\r\n}\r\n\r\nfunction getPositionY(\r\n  curY: number,\r\n  canvasHeight: number,\r\n  trackOrTileHeight: number,\r\n  useFloor: boolean\r\n) {\r\n  if (curY < 0) {\r\n    return 0;\r\n  }\r\n\r\n  if (curY + trackOrTileHeight > canvasHeight) {\r\n    return canvasHeight - trackOrTileHeight;\r\n  }\r\n\r\n  if (useFloor) {\r\n    return Math.floor(curY / trackOrTileHeight) * trackOrTileHeight;\r\n  } else {\r\n    return Math.round(curY / trackOrTileHeight) * trackOrTileHeight;\r\n  }\r\n}\r\n\r\nexport { getPositionX, getPositionY };\r\n","import Konva from \"konva\";\r\nimport { Rect, Transformer } from \"react-konva\";\r\nimport { useRef, useEffect } from \"react\";\r\nimport { getPositionX, getPositionY } from \"../../GetPositionFunctions\";\r\nimport { ShapeProps, CanvasProps } from \"../../Interfaces\";\r\n\r\ninterface Props {\r\n  dataKey: number;\r\n  shapeProps: ShapeProps;\r\n  isSelected: boolean;\r\n  canvasProps: CanvasProps;\r\n  handleSelect: (isDragging: boolean) => void;\r\n  changeSize: (newSize: number) => void;\r\n  changePos: (newPosX: number, newPosY: number) => void;\r\n}\r\n\r\nfunction MidiClip(props: Props) {\r\n  const canvasWidth = props.canvasProps.canvasWidth;\r\n  const canvasHeight = props.canvasProps.canvasHeight;\r\n  const blockSnapSize = props.canvasProps.blockSnapSize;\r\n  const trackHeight = props.canvasProps.trackOrTileHeight;\r\n  const gridPadding = props.canvasProps.gridPadding;\r\n\r\n  const midiClipRef = useRef<Konva.Rect>(null);\r\n  const trRefMidi = useRef<Konva.Transformer>(null);\r\n\r\n  // console.log(\"!!IN MIDI \", props.dataKey, \" shapeProps: \", props.shapeProps);\r\n\r\n  useEffect(() => {\r\n    if (props.isSelected) {\r\n      trRefMidi.current!.nodes([midiClipRef.current!]);\r\n      trRefMidi.current!.getLayer()!.batchDraw();\r\n    }\r\n  }, [props.isSelected]);\r\n\r\n  // useEffect(() => {\r\n  //   midiClipRef.current!.position({\r\n  //     x: props.shapeProps.posX,\r\n  //     y: props.shapeProps.posY,\r\n  //   });\r\n  //   midiClipRef.current!.draw();\r\n  //   midiClipRef.current!.getParent().draw();\r\n  //   console.log(\"REDRAW MIDI\", midiClipRef.current!.getPosition());\r\n  // }, [props.shapeProps]);\r\n\r\n  return (\r\n    <>\r\n      <Rect\r\n        dataKey={props.dataKey}\r\n        ref={midiClipRef}\r\n        x={props.shapeProps.posX}\r\n        y={props.shapeProps.posY}\r\n        width={props.shapeProps.width * blockSnapSize * (gridPadding / 16)}\r\n        height={trackHeight}\r\n        stroke=\"black\"\r\n        strokeWidth={0.1}\r\n        cornerRadius={10}\r\n        fill={props.shapeProps.color}\r\n        draggable={true}\r\n        onDragStart={(e) => {\r\n          if (e.evt.button === 0) {\r\n            props.handleSelect(true);\r\n          }\r\n        }}\r\n        onClick={(e) => {\r\n          if (e.evt.button === 0) {\r\n            props.handleSelect(false);\r\n          }\r\n        }}\r\n        onDragEnd={(e) => {\r\n          const posX = getPositionX(\r\n            e.target.x(),\r\n            e.target.width(),\r\n            canvasWidth,\r\n            blockSnapSize,\r\n            false\r\n          );\r\n          const posY = getPositionY(\r\n            e.target.y(),\r\n            canvasHeight,\r\n            trackHeight,\r\n            false\r\n          );\r\n\r\n          e.target.position({\r\n            x: props.shapeProps.posX,\r\n            y: props.shapeProps.posY,\r\n          });\r\n\r\n          props.changePos(posX, posY);\r\n        }}\r\n        onTransformEnd={(e) => {\r\n          const scaleAmmount = midiClipRef.current!.scaleX();\r\n          midiClipRef.current!.scaleX(1);\r\n          const newSize = Math.round(props.shapeProps.width * scaleAmmount);\r\n\r\n          if (newSize * blockSnapSize > canvasWidth - e.target.x()) {\r\n            props.changeSize(\r\n              Math.round((canvasWidth - e.target.x()) / blockSnapSize)\r\n            );\r\n          } else {\r\n            props.changeSize(newSize);\r\n          }\r\n        }}\r\n      />\r\n      {props.isSelected && (\r\n        <Transformer\r\n          key=\"trMidi\"\r\n          ref={trRefMidi}\r\n          enabledAnchors={[\"middle-right\"]}\r\n          rotateEnabled={false}\r\n          borderStroke=\"orange\"\r\n          anchorCornerRadius={5}\r\n          anchorFill=\"orange\"\r\n          anchorStrokeWidth={0}\r\n          resizeEnabled={true}\r\n          boundBoxFunc={(oldBox, newBox) => {\r\n            if (newBox.width < blockSnapSize * (gridPadding / 16)) {\r\n              trRefMidi.current!.stopTransform();\r\n              return oldBox;\r\n            }\r\n\r\n            if (newBox.width > blockSnapSize * gridPadding) {\r\n              return oldBox;\r\n            }\r\n\r\n            return newBox;\r\n          }}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MidiClip;\r\n","import { Stage, Line, Layer, Rect } from \"react-konva\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport MidiClip from \"./MidiClip\";\r\nimport { getPositionX, getPositionY } from \"../../GetPositionFunctions\";\r\nimport {\r\n  MidiClip as MidiClipInterface,\r\n  MidiClipRectProps,\r\n  MidiNote,\r\n  Rootstate,\r\n} from \"../../Interfaces\";\r\nimport \"./ArrangementCanvas.css\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n  addNewMidiClip,\r\n  selectMidiClip,\r\n  deselectMidiClip,\r\n  deleteMidiClip,\r\n  updateMidiClip,\r\n  changeTransportPosition,\r\n} from \"../../Actions\";\r\nimport Konva from \"konva\";\r\nimport * as Tone from \"tone\";\r\nimport React from \"react\";\r\n\r\nfunction getMidiClipStartTime(\r\n  posX: number,\r\n  blockSnapSize: number,\r\n  blockSnapSizeToTick: number\r\n) {\r\n  return (posX / blockSnapSize) * blockSnapSizeToTick;\r\n}\r\n\r\nfunction getMidiClipTrackKey(posY: number, trackHeight: number) {\r\n  return posY / trackHeight;\r\n}\r\n\r\nfunction getMidiClipFromRect(\r\n  midiClipRect: MidiClipRectProps,\r\n  midiClipNotes: MidiNote[],\r\n  trackHeight: number,\r\n  blockSnapSize: number,\r\n  blockSnapSizeToTick: number\r\n): MidiClipInterface {\r\n  return {\r\n    dataKey: midiClipRect.dataKey,\r\n    trackKey: getMidiClipTrackKey(midiClipRect.posY, trackHeight),\r\n    startTime: getMidiClipStartTime(\r\n      midiClipRect.posX,\r\n      blockSnapSize,\r\n      blockSnapSizeToTick\r\n    ),\r\n    length: midiClipRect.width,\r\n    notes: midiClipNotes,\r\n  };\r\n}\r\n\r\nfunction initMidiClipRects(\r\n  midiClips: MidiClipPos[],\r\n  blockSnapSize: number,\r\n  blockSnapSizeToTick: number,\r\n  trackHeight: number\r\n) {\r\n  const initedMidiClips = midiClips.map((midiClip) => {\r\n    return {\r\n      dataKey: midiClip.dataKey,\r\n      posX: (midiClip.startTime / blockSnapSizeToTick) * blockSnapSize,\r\n      posY: midiClip.trackKey * trackHeight,\r\n      width: midiClip.length,\r\n    };\r\n  });\r\n\r\n  // console.log(\"initMidi\", initedMidiClips);\r\n  return initedMidiClips;\r\n}\r\n\r\ninterface MidiClipPos {\r\n  dataKey: number;\r\n  trackKey: number;\r\n  length: number;\r\n  startTime: number;\r\n}\r\n\r\ninterface Props {\r\n  midiClipsPos: MidiClipPos[];\r\n  numOfTracks: number;\r\n  isImported: boolean;\r\n}\r\n\r\nfunction initMidiKeyGenerator(midiClipPos: MidiClipPos[]) {\r\n  if (midiClipPos.length === 0) {\r\n    return 0;\r\n  }\r\n\r\n  return (\r\n    Math.max.apply(\r\n      Math,\r\n      midiClipPos.map((midiClip) => {\r\n        return midiClip.dataKey;\r\n      })\r\n    ) + 1\r\n  );\r\n}\r\n\r\nconst ArrangementCanvas = React.memo((props: Props) => {\r\n  // TODO: these values have to be responsive, if window resize event fires up, also less hardcoded\r\n\r\n  // console.log(\"IN ARR CANVAS\", props.midiClipsPos);\r\n\r\n  const trackHeight = 100 + 2; // + 2 -> margins and gaps\r\n  const numOfTracks = props.numOfTracks;\r\n\r\n  // TODO: lecheckolni, hogy ha lerövidítjük a track hosszát, akkor mi lesz azokkal a midiclippekkel amik \"kilógnának\"\r\n  const numOfPhrases = useSelector(\r\n    (state: Rootstate) => state.arrCanvasProps.numOfPhrases\r\n  ); // Phrase = 4 measures\r\n  const gridPadding = useSelector(\r\n    (state: Rootstate) => state.arrCanvasProps.gridPadding\r\n  ); // 1 / gridPadding -> how many grids in a phrase\r\n  const midiClipColor = useSelector(\r\n    (state: Rootstate) => state.arrCanvasProps.midiClipColor\r\n  );\r\n\r\n  const blockSnapSizeToTick = 192 / (gridPadding / 16);\r\n  const dispatch = useDispatch();\r\n  const curPositionRef = useRef<Konva.Rect>(null);\r\n  const curPositionLayer = useRef<Konva.Layer>(null);\r\n  // const [positionEventID, setPositionEventID]= useState<number | null>(null);\r\n\r\n  // should be a hardcoded \"4\", so the first 4 measure will fit on the screen no problem\r\n  //const canvasWidth = window.innerWidth - 61 - ((window.innerWidth - 61) % 4);\r\n  const canvasWidth =\r\n    numOfPhrases < 4\r\n      ? window.innerWidth -\r\n        61 +\r\n        (numOfPhrases * gridPadding -\r\n          ((window.innerWidth - 61) % (numOfPhrases * gridPadding)))\r\n      : (window.innerWidth -\r\n          61 +\r\n          (numOfPhrases * gridPadding -\r\n            ((window.innerWidth - 61) % (numOfPhrases * gridPadding)))) *\r\n        (numOfPhrases / 4);\r\n  // TODO: if numOfPhrases > 4 then we should use a vertical scrollbar to navigate\r\n\r\n  const canvasHeight = trackHeight * numOfTracks; //only show the neccessary ammount of rows\r\n\r\n  // TODO: blockSnapSize should be changeable, and the canvas should draw invisible lines to snap to\r\n  const blockSnapSize = Math.round(canvasWidth / (numOfPhrases * gridPadding));\r\n\r\n  const [midiKeyGenerator, setMidiKeyGenerator] = useState<number>(0);\r\n  const [selectedMidiClipId, selectMidiClipId] = useState<number>(-1);\r\n\r\n  useEffect(() => {\r\n    if (!props.isImported) {\r\n      return;\r\n    }\r\n\r\n    setMidiKeyGenerator(initMidiKeyGenerator(props.midiClipsPos));\r\n  }, [props.isImported, props.midiClipsPos]);\r\n\r\n  const curMidiClipsRect: MidiClipRectProps[] = initMidiClipRects(\r\n    props.midiClipsPos,\r\n    blockSnapSize,\r\n    blockSnapSizeToTick,\r\n    trackHeight\r\n  );\r\n\r\n  // useEffect(() => {\r\n  //   midiClipLayerRef.current!.draw();\r\n  // }, [props.midiClipsPos])\r\n\r\n  // console.log(\"AFTER INITED MIDIS\", curMidiClipsRect);\r\n\r\n  let gridLines: JSX.Element[] = [];\r\n\r\n  for (let i = 0; i <= numOfPhrases * gridPadding; i += 1) {\r\n    gridLines.push(\r\n      <Line\r\n        key={\"arrangeV_\" + i}\r\n        name=\"line\"\r\n        points={[\r\n          i * blockSnapSize + 0.5,\r\n          0,\r\n          i * blockSnapSize + 0.5,\r\n          canvasHeight,\r\n        ]}\r\n        stroke={i % (gridPadding / 4) ? \"gray\" : \"black\"} // TODO: If time signature can be changed, then 4 should NOT be hardcoded here\r\n        strokeWidth={i % (gridPadding / 4) ? 1 : 1.5}\r\n      />\r\n    );\r\n  }\r\n\r\n  for (let i = 0; i < canvasHeight; i += trackHeight) {\r\n    gridLines.push(\r\n      <Line\r\n        key={\"arrangeH_\" + i}\r\n        name=\"line\"\r\n        points={[0, i, canvasWidth, i]}\r\n        stroke=\"gray\"\r\n        strokeWidth={1}\r\n      />\r\n    );\r\n  }\r\n\r\n  let darkMeasureRects: JSX.Element[] = [];\r\n\r\n  for (let i = 1; i <= numOfPhrases / 2; i++) {\r\n    darkMeasureRects.push(\r\n      <Rect\r\n        key={\"d_\" + i * 2}\r\n        name=\"darkMeasure\"\r\n        x={i * 2 * (canvasWidth / numOfPhrases) - canvasWidth / numOfPhrases}\r\n        y={0}\r\n        height={canvasHeight}\r\n        width={canvasWidth / numOfPhrases}\r\n        fill=\"#aaa\"\r\n        opacity={0.5}\r\n      />\r\n    );\r\n  }\r\n\r\n  useEffect(() => {\r\n    Tone.Transport.loop = true;\r\n    Tone.Transport.loopEnd = `${numOfPhrases * 4}m`;\r\n  }, [numOfPhrases]);\r\n\r\n  useEffect(() => {\r\n    // console.log(\"!!!!!IN CURTRANSPORT USEFF\", positionEventID);\r\n\r\n    // if (positionEventID !== null) {\r\n    //   Tone.Transport.clear(positionEventID);\r\n    // }\r\n\r\n    // const eventID =\r\n    Tone.Transport.scheduleRepeat((time) => {\r\n      Tone.Draw.schedule(() => {\r\n        if (Tone.Transport.state === \"stopped\") {\r\n          return;\r\n        }\r\n\r\n        curPositionRef.current!.position({\r\n          x: Math.trunc(canvasWidth * Tone.Transport.progress) - 20,\r\n          y: 0,\r\n        });\r\n        curPositionLayer.current!.draw();\r\n        // console.log(Tone.Transport.progress, Math.trunc(canvasWidth * Tone.Transport.progress) - 20);\r\n      }, time);\r\n    }, \"10i\");\r\n\r\n    // setPositionEventID(eventID);\r\n    // console.log(\"NEWID\",positionEventID)\r\n  }, [canvasWidth]);\r\n\r\n  const curPositionRect = (\r\n    <Rect\r\n      x={-20}\r\n      y={0}\r\n      width={10}\r\n      height={canvasHeight}\r\n      fillLinearGradientStartPoint={{ x: 0, y: 0 }}\r\n      fillLinearGradientEndPoint={{ x: 10, y: 0 }}\r\n      fillLinearGradientColorStops={[\r\n        0,\r\n        \"transparent\",\r\n        0.5,\r\n        \"orange\",\r\n        1,\r\n        \"transparent\",\r\n      ]}\r\n      opacity={0.7}\r\n      ref={curPositionRef}\r\n    />\r\n  );\r\n\r\n  return (\r\n    <div key=\"arrangementCanvas\">\r\n      <Stage\r\n        key=\"arrangementStage\"\r\n        className=\"stageClass\"\r\n        width={canvasWidth + 2}\r\n        // + 2 is needed if a note's transform anchor is at the edge, so the user can reach it\r\n        height={canvasHeight}\r\n        onMouseDown={(e) => {\r\n          e.evt.preventDefault();\r\n\r\n          if (e.evt.button === 0) {\r\n            // left mouse button\r\n            if (selectedMidiClipId !== -1) {\r\n              if (\r\n                e.target === e.target.getStage() ||\r\n                e.target.getAttr(\"name\") === \"darkMeasure\" ||\r\n                e.target.getAttr(\"name\") === \"line\"\r\n              ) {\r\n                selectMidiClipId(-1);\r\n                dispatch(deselectMidiClip());\r\n              }\r\n            }\r\n          } else if (e.evt.button === 1 && Tone.Transport.state === \"stopped\") {\r\n            // middle mouse button\r\n\r\n            const transform = e.currentTarget\r\n              .getAbsoluteTransform()\r\n              .copy()\r\n              .invert();\r\n            const pos = e.currentTarget.getStage()!.getPointerPosition()!;\r\n\r\n            const posX = getPositionX(\r\n              transform.point(pos).x,\r\n              4 * blockSnapSize,\r\n              canvasWidth,\r\n              blockSnapSize,\r\n              false\r\n            );\r\n\r\n            // console.log(posX);\r\n            dispatch(\r\n              changeTransportPosition(\r\n                (posX / blockSnapSize) * blockSnapSizeToTick\r\n              )\r\n            );\r\n            curPositionRef.current!.position({\r\n              x: posX - 5,\r\n              y: 0,\r\n            });\r\n            curPositionRef.current!.getLayer()!.draw();\r\n          }\r\n        }}\r\n        onDblClick={(e) => {\r\n          if (e.evt.button !== 0) {\r\n            return;\r\n          }\r\n\r\n          // Adding new MIDI clip\r\n          if (e.target.getAttr(\"dataKey\") === undefined) {\r\n            const transform = e.currentTarget\r\n              .getAbsoluteTransform()\r\n              .copy()\r\n              .invert();\r\n            const pos = e.currentTarget.getStage()!.getPointerPosition()!;\r\n\r\n            const newMidiClipRect = {\r\n              dataKey: midiKeyGenerator,\r\n              posX: getPositionX(\r\n                transform.point(pos).x,\r\n                4 * blockSnapSize,\r\n                canvasWidth,\r\n                blockSnapSize,\r\n                true\r\n              ),\r\n              posY: getPositionY(\r\n                transform.point(pos).y,\r\n                canvasHeight,\r\n                trackHeight,\r\n                true\r\n              ),\r\n              width: 4,\r\n            };\r\n\r\n            const newMidi = getMidiClipFromRect(\r\n              newMidiClipRect,\r\n              [],\r\n              trackHeight,\r\n              blockSnapSize,\r\n              blockSnapSizeToTick\r\n            );\r\n\r\n            setMidiKeyGenerator(midiKeyGenerator + 1);\r\n            dispatch(\r\n              addNewMidiClip({\r\n                midiClipDataKey: newMidi.dataKey,\r\n                trackDataKey: newMidi.trackKey,\r\n                type: \"ADD\",\r\n                newMidiClipProps: newMidi,\r\n              })\r\n            );\r\n          }\r\n        }}\r\n        onContextMenu={(e) => {\r\n          e.evt.preventDefault();\r\n        }}\r\n      >\r\n        <Layer key=\"arrangementDarkMeasures\">{darkMeasureRects}</Layer>\r\n        <Layer key=\"arrangementGridLines\">{gridLines}</Layer>\r\n        <Layer\r\n          key=\"arrangementMidiClips\"\r\n          onClick={(e) => {\r\n            if (e.evt.button === 2) {\r\n              const midiClipToDeleteDataKey = e.target.getAttr(\"dataKey\");\r\n\r\n              dispatch(deselectMidiClip());\r\n\r\n              // Only need the dataKey and trackKey to delete a midi clip\r\n              dispatch(\r\n                deleteMidiClip({\r\n                  midiClipDataKey: midiClipToDeleteDataKey,\r\n                  trackDataKey: getMidiClipTrackKey(\r\n                    curMidiClipsRect.find(\r\n                      (item) => item.dataKey === midiClipToDeleteDataKey\r\n                    )!.posY,\r\n                    trackHeight\r\n                  ),\r\n                  type: \"DELETE\",\r\n                })\r\n              );\r\n            }\r\n          }}\r\n        >\r\n          {curMidiClipsRect.map((item, i) => {\r\n            return (\r\n              <MidiClip\r\n                key={item.dataKey}\r\n                dataKey={item.dataKey}\r\n                shapeProps={{\r\n                  posX: item.posX,\r\n                  posY: item.posY,\r\n                  width: item.width,\r\n                  color: midiClipColor,\r\n                }}\r\n                isSelected={item.dataKey === selectedMidiClipId}\r\n                canvasProps={{\r\n                  canvasHeight: canvasHeight,\r\n                  blockSnapSize: blockSnapSize,\r\n                  canvasWidth: canvasWidth,\r\n                  trackOrTileHeight: trackHeight,\r\n                  gridPadding: gridPadding,\r\n                }}\r\n                handleSelect={(isDragging: boolean) => {\r\n                  if (selectedMidiClipId !== item.dataKey) {\r\n                    if (selectedMidiClipId !== -1) {\r\n                      dispatch(deselectMidiClip());\r\n                    }\r\n\r\n                    selectMidiClipId(item.dataKey);\r\n                  }\r\n                  if (!isDragging) {\r\n                    dispatch(\r\n                      selectMidiClip(\r\n                        getMidiClipTrackKey(item.posY, trackHeight),\r\n                        item.dataKey\r\n                      )\r\n                    );\r\n                  }\r\n                }}\r\n                changeSize={(newSize) => {\r\n                  if (newSize === curMidiClipsRect[i].width) {\r\n                    return;\r\n                  }\r\n\r\n                  const newMidiClip = getMidiClipFromRect(\r\n                    {\r\n                      dataKey: curMidiClipsRect[i].dataKey,\r\n                      posX: curMidiClipsRect[i].posX,\r\n                      posY: curMidiClipsRect[i].posY,\r\n                      width: newSize,\r\n                    },\r\n                    [], // no need for notes, they won't be changed\r\n                    trackHeight,\r\n                    blockSnapSize,\r\n                    blockSnapSizeToTick\r\n                  );\r\n\r\n                  // TODO:\r\n                  // WHEN WE MOVE MIDICLIP, WE NEED AN OTHER PROP: prevTrackKey, or stmh like that\r\n                  // ALSO a ModifyMidiClip interface would be nice, to again, optimize the Track component\r\n                  dispatch(\r\n                    updateMidiClip({\r\n                      midiClipDataKey: newMidiClip.dataKey,\r\n                      trackDataKey: newMidiClip.trackKey,\r\n                      type: \"UPDATE\",\r\n                      newMidiClipProps: newMidiClip,\r\n                    })\r\n                  );\r\n                }}\r\n                changePos={(newPosX: number, newPosY: number) => {\r\n                  if (\r\n                    newPosX === curMidiClipsRect[i].posX &&\r\n                    newPosY === curMidiClipsRect[i].posY\r\n                  ) {\r\n                    return;\r\n                  }\r\n\r\n                  const prevTrackKey = getMidiClipTrackKey(\r\n                    curMidiClipsRect[i].posY,\r\n                    trackHeight\r\n                  );\r\n\r\n                  const newMidiClip = getMidiClipFromRect(\r\n                    {\r\n                      dataKey: curMidiClipsRect[i].dataKey,\r\n                      posX: newPosX,\r\n                      posY: newPosY,\r\n                      width: curMidiClipsRect[i].width,\r\n                    },\r\n                    [],\r\n                    trackHeight,\r\n                    blockSnapSize,\r\n                    blockSnapSizeToTick\r\n                  );\r\n\r\n                  dispatch(\r\n                    updateMidiClip({\r\n                      midiClipDataKey: newMidiClip.dataKey,\r\n                      trackDataKey: prevTrackKey,\r\n                      type: \"UPDATE\",\r\n                      newMidiClipProps: newMidiClip,\r\n                    })\r\n                  );\r\n                }}\r\n              />\r\n            );\r\n          })}\r\n        </Layer>\r\n        <Layer key=\"curPosition\" ref={curPositionLayer}>\r\n          {curPositionRect}\r\n        </Layer>\r\n      </Stage>\r\n    </div>\r\n  );\r\n});\r\n\r\nexport default ArrangementCanvas;\r\n","export default __webpack_public_path__ + \"static/media/powerOnButton.5d4f8dba.png\";","export default __webpack_public_path__ + \"static/media/powerOffButton.565e8b96.png\";","import { useEffect, useRef, useState } from \"react\";\r\nimport * as Tone from \"tone\";\r\nimport { SampleProps } from \"../../Interfaces\";\r\nimport \"./AudioSampler.css\";\r\nimport powerOnButton from \"../../Icons/powerOnButton.png\";\r\nimport powerOffButton from \"../../Icons/powerOffButton.png\";\r\n\r\ninterface Props {\r\n  sampleProps: SampleProps;\r\n}\r\n\r\nfunction handlePowerButton(\r\n  isOn: boolean,\r\n  setIsOn: React.Dispatch<React.SetStateAction<boolean>>,\r\n  powerButtonRef: React.RefObject<HTMLImageElement>\r\n) {\r\n  if (isOn) {\r\n    powerButtonRef.current!.src = powerOffButton;\r\n    setIsOn(false);\r\n  } else {\r\n    powerButtonRef.current!.src = powerOnButton;\r\n    setIsOn(true);\r\n  }\r\n}\r\n\r\nfunction AudioSampler(props: Props) {\r\n  const [isOn, setIsOn] = useState<boolean>(false);\r\n  const [curEvent, setCurEvent] = useState<number>(-1);\r\n  const powerButtonRef = useRef<HTMLImageElement>(null);\r\n\r\n  useEffect(() => {\r\n    if (curEvent === -1 && isOn) {\r\n      const context = new AudioContext();\r\n\r\n      fetch(props.sampleProps.samplePath)\r\n        .then((response) => response.arrayBuffer())\r\n        .then((arrayBuffer) => context.decodeAudioData(arrayBuffer))\r\n        .then((audioBuffer) => {\r\n          const sampler = new Tone.Sampler({\r\n            urls: {\r\n              C4: audioBuffer,\r\n            },\r\n            onload: () => {\r\n              const eventID = Tone.Transport.scheduleRepeat(\r\n                (time) => {\r\n                  sampler.triggerAttackRelease(\"C4\", \"8n\", time);\r\n                },\r\n                `${props.sampleProps.sampleRepeatTime}i`,\r\n                `${props.sampleProps.sampleStartTime}i`\r\n              );\r\n              setCurEvent(eventID);\r\n            },\r\n          }).toDestination();\r\n        })\r\n        .catch((error) => console.log(error));\r\n    } else if (!isOn && curEvent !== -1) {\r\n      Tone.Transport.clear(curEvent);\r\n      setCurEvent(-1);\r\n    }\r\n  }, [props.sampleProps, curEvent, isOn]);\r\n\r\n  return (\r\n    <div className=\"audioSampler\">\r\n      <span>{props.sampleProps.sampleName}</span>\r\n      <img\r\n        src={powerOffButton}\r\n        alt=\"powerButton\"\r\n        ref={powerButtonRef}\r\n        onClick={() => handlePowerButton(isOn, setIsOn, powerButtonRef)}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AudioSampler;\r\n","export default __webpack_public_path__ + \"static/media/Kick.a8730778.wav\";","export default __webpack_public_path__ + \"static/media/OpenHihat.23e1e1e5.wav\";","import Kick from \"../../Samples/Kick.wav\";\r\nimport OpenHihat from \"../../Samples/OpenHihat.wav\";\r\nimport Clap from \"../../Samples/Clap.wav\";\r\nimport Ride from \"../../Samples/Ride.wav\";\r\nimport Crash from \"../../Samples/Crash.wav\";\r\n\r\nconst samplePaths = [Kick, Clap, OpenHihat, Ride, Crash];\r\nconst sampleStartTime = [0, 192, 96, 0, 1440];\r\nconst sampleRepeatTime = [192, 384, 192, 96, 1536];\r\nconst sampleName = [\r\n  \"Lábdob\",\r\n  \"Taps\",\r\n  \"Lábcin\",\r\n  \"Kísérő cintányér\",\r\n  \"Beütő cintányér\",\r\n];\r\n\r\nexport { samplePaths, sampleStartTime, sampleRepeatTime, sampleName };\r\n","export default __webpack_public_path__ + \"static/media/Clap.90707c55.wav\";","export default __webpack_public_path__ + \"static/media/Ride.f03f5a83.wav\";","export default __webpack_public_path__ + \"static/media/Crash.3028beaa.wav\";","import Track from \"./ArrangementViewComponents/Track\";\r\nimport \"./ArrangementView.css\";\r\nimport ArrangementCanvas from \"./ArrangementViewComponents/ArrangementCanvas\";\r\nimport { Rootstate } from \"../Interfaces\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport addButton from \"../Icons/addButton.png\";\r\nimport { useEffect, useState } from \"react\";\r\nimport NewTrackModal from \"./ArrangementViewComponents/NewTrackModal\";\r\nimport AudioSampler from \"./ArrangementViewComponents/AudioSampler\";\r\nimport {\r\n  sampleName,\r\n  samplePaths,\r\n  sampleRepeatTime,\r\n  sampleStartTime,\r\n} from \"./ArrangementViewComponents/AudioSampleImport\";\r\nimport { tracksCleared } from \"../Actions\";\r\n// import { useState } from \"react\";\r\n\r\nfunction ArrangementView() {\r\n  const curTrackInfos = useSelector((state: Rootstate) => state.curTracks);\r\n  const disposeTracks = useSelector((state: Rootstate) => state.disposeTracks);\r\n  const [showModal, setShowModal] = useState<boolean>(false);\r\n  const dispatch = useDispatch();\r\n\r\n  // function getNotesForMidiClip(trackKey: number, dataKey: number) {\r\n\r\n  //   const midiClipIndex = curTrackInfos.tracks[trackKey].midiClips\r\n  //     .findIndex((midiclip) => midiclip.dataKey === dataKey);\r\n\r\n  //   return curTrackInfos.tracks[trackKey].midiClips[midiClipIndex].notes;\r\n  // }\r\n\r\n  // const curNoteToModify = useSelector((state: Rootstate) => state.modifyNote);\r\n  // const [keyGenerator, setKeyGenerator] = useState<number>(curTrackInfos.length);\r\n\r\n  // console.log(\"RENDERING ARR VIEW\", curTrackInfos);\r\n  //console.log(curNoteToModify);\r\n\r\n  useEffect(() => {\r\n    if (disposeTracks) {\r\n      dispatch(tracksCleared());\r\n    }\r\n  }, [disposeTracks, dispatch]);\r\n\r\n  return (\r\n    //List the tracks here\r\n    <>\r\n      <div key=\"arrangementViewContainer\" className=\"arrangementViewContainer\">\r\n        <div key=\"trackHeaders\" className=\"trackHeaderColumn\">\r\n          {curTrackInfos.tracks.map((item) => {\r\n            return (\r\n              <Track\r\n                key={item.dataKey}\r\n                dataKey={item.dataKey}\r\n                trackName={item.name}\r\n                // trackColor={item.color}\r\n                instrumentName={item.instrument}\r\n                isMuted={item.isMuted}\r\n                isDisposed={disposeTracks}\r\n                curNoteToModify={\r\n                  curTrackInfos.modifiedNote !== null\r\n                    ? curTrackInfos.modifiedNote.trackDataKey === item.dataKey\r\n                      ? curTrackInfos.modifiedNote\r\n                      : null\r\n                    : null\r\n                }\r\n                curMidiClipToModify={\r\n                  curTrackInfos.modifiedMidiClip !== null\r\n                    ? curTrackInfos.modifiedMidiClip.trackDataKey ===\r\n                      item.dataKey\r\n                      ? curTrackInfos.modifiedMidiClip\r\n                      : curTrackInfos.modifiedMidiClip.newMidiClipProps !==\r\n                        undefined\r\n                      ? curTrackInfos.modifiedMidiClip.newMidiClipProps\r\n                          .trackKey === item.dataKey\r\n                        ? curTrackInfos.modifiedMidiClip\r\n                        : null\r\n                      : null\r\n                    : null\r\n                }\r\n                midiClips={\r\n                  curTrackInfos.isImported\r\n                    ? curTrackInfos.tracks[item.dataKey].midiClips\r\n                    : null\r\n                }\r\n              />\r\n            );\r\n          })}\r\n          <NewTrackModal\r\n            showModal={showModal}\r\n            setShowModal={setShowModal}\r\n            mode=\"add\"\r\n          />\r\n          <button\r\n            className=\"addNewTrackButton\"\r\n            onClick={() => setShowModal(true)}\r\n          >\r\n            <img\r\n              className=\"addNewTrackImg\"\r\n              src={addButton}\r\n              alt=\"\"\r\n              width=\"15px\"\r\n            />\r\n            Új sáv...\r\n          </button>\r\n        </div>\r\n        <ArrangementCanvas\r\n          // TODO: elég ha a midiclip azon paramétereit adjuk át, ami elég az elhelyezéséhez.\r\n          // A piano roll tudni fogja, hogy miylen noteok lesznek benne, ezért az arr canvasnak nem kell ezt tudnia\r\n          // midiClips={curTrackInfos.tracks\r\n          //   .map((track) => {\r\n          //     return track.midiClips;\r\n          //   })\r\n          //   .flat()}\r\n          isImported={curTrackInfos.isImported}\r\n          midiClipsPos={curTrackInfos.tracks.flatMap((track) => {\r\n            return track.midiClips.map((midiClip) => {\r\n              return {\r\n                dataKey: midiClip.dataKey,\r\n                trackKey: midiClip.trackKey,\r\n                startTime: midiClip.startTime,\r\n                length: midiClip.length,\r\n              };\r\n            });\r\n          })}\r\n          numOfTracks={curTrackInfos.tracks.length}\r\n        />\r\n      </div>\r\n      <div className=\"audioSamplerContainer\">\r\n        {samplePaths.map((path, i) => {\r\n          return (\r\n            <AudioSampler\r\n              key={i}\r\n              sampleProps={{\r\n                samplePath: path,\r\n                sampleName: sampleName[i],\r\n                sampleStartTime: sampleStartTime[i],\r\n                sampleRepeatTime: sampleRepeatTime[i],\r\n              }}\r\n            />\r\n          );\r\n        })}\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default ArrangementView;\r\n","export default \"data:image/png;base64,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\"","import firebase from \"firebase/app\";\r\nimport \"firebase/auth\";\r\nimport \"firebase/firestore\";\r\n\r\nconst config = {\r\n  apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\r\n  authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\r\n  projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\r\n  storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\r\n  messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,\r\n  appId: process.env.REACT_APP_FIREBASE_APP_ID,\r\n};\r\n\r\nconst app = firebase.initializeApp(config);\r\n\r\nconst appStore = app.firestore();\r\nconst appAuth = app.auth();\r\n\r\nexport { appAuth, appStore };\r\n","import React, { useRef, useState } from \"react\";\r\nimport ReactModal from \"react-modal\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport {\r\n  changeMidiClipColor,\r\n  changeMidiNoteColor,\r\n  clearEveryTrack,\r\n  exportProject,\r\n  importProject,\r\n  setImportedBPM,\r\n} from \"../Actions\";\r\nimport { appStore, appAuth } from \"../firebase\";\r\nimport { TrackInterface } from \"../Interfaces\";\r\nimport \"./Footer.css\";\r\n\r\nfunction checkSignUpCredentials(\r\n  emailRef: React.RefObject<HTMLInputElement>,\r\n  // nameRef: React.RefObject<HTMLInputElement>,\r\n  passwordRef: React.RefObject<HTMLInputElement>,\r\n  passwordConfirmRef: React.RefObject<HTMLInputElement>\r\n) {\r\n  if (emailRef.current!.validity.valueMissing) {\r\n    alert(\"Kérlek add meg az email címed!\");\r\n    return false;\r\n  }\r\n\r\n  if (\r\n    emailRef.current!.value.match(\r\n      /^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]{2,}$/\r\n    ) === null\r\n  ) {\r\n    alert(\"A megadott email cím nem valid!\");\r\n    return false;\r\n  }\r\n\r\n  // if (nameRef.current!.validity.valueMissing) {\r\n  //   alert(\"Kérlek adj meg egy felhasználónevet!\");\r\n  //   return false;\r\n  // }\r\n\r\n  // if (nameRef.current!.validity.tooShort) {\r\n  //   alert(\r\n  //     \"A megadott felhasznólónév túl rövid, 5 - 20 karakterből kell állnia!\"\r\n  //   );\r\n  //   return false;\r\n  // }\r\n\r\n  if (passwordRef.current!.validity.valueMissing) {\r\n    alert(\"Kérlek adj meg egy jelszót!\");\r\n    return false;\r\n  }\r\n\r\n  if (passwordRef.current!.validity.tooShort) {\r\n    alert(\"A megadott jelszó túl rövid, 5 - 15 karakterből kell, hogy álljon!\");\r\n    return false;\r\n  }\r\n\r\n  if (passwordConfirmRef.current!.validity.valueMissing) {\r\n    alert(\"Kérlek erősítsed meg a jelszavad!\");\r\n    return false;\r\n  }\r\n\r\n  if (passwordRef.current!.value !== passwordConfirmRef.current!.value) {\r\n    alert(\"A két megadott jelszó nem egyezik!\");\r\n    return false;\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nfunction Footer() {\r\n  const dispatch = useDispatch();\r\n  const [isLoggedIn, setIsLoggedIn] = useState<boolean>(\r\n    appAuth.currentUser !== null\r\n  );\r\n  const [isPrefOpen, setIsPrefOpen] = useState<boolean>(false);\r\n  const [isSignUpOpen, setIsSignUpOpen] = useState<boolean>(false);\r\n  const [isSignInOpen, setIsSignInOpen] = useState<boolean>(false);\r\n\r\n  const emailRef = useRef<HTMLInputElement>(null);\r\n  // const nameRef = useRef<HTMLInputElement>(null);\r\n  const passwordRef = useRef<HTMLInputElement>(null);\r\n  const passwordConfirmRef = useRef<HTMLInputElement>(null);\r\n\r\n  const signInEmailRef = useRef<HTMLInputElement>(null);\r\n  const signInPasswordRef = useRef<HTMLInputElement>(null);\r\n\r\n  const prefThemeRef = useRef<HTMLSelectElement>(null);\r\n  const prefMidiClipColor = useRef<HTMLInputElement>(null);\r\n  const prefMidiNoteColor = useRef<HTMLInputElement>(null);\r\n\r\n  return (\r\n    <footer>\r\n      {isLoggedIn ? (\r\n        <>\r\n          <button\r\n            onClick={() => {\r\n              appAuth.signOut().catch((error) => {\r\n                alert(\"Hiba történt kijelentkezéskor!\");\r\n                console.log(error);\r\n              });\r\n\r\n              const root = document.documentElement;\r\n              root.style.setProperty(\"--modal-bg-color\", \"rgb(40, 40, 40)\");\r\n              root.style.setProperty(\"--main-bg-color\", \"rgb(40, 40, 40)\");\r\n\r\n              dispatch(changeMidiNoteColor(\"#6fff00\"));\r\n              dispatch(changeMidiClipColor(\"grey\"));\r\n              setIsLoggedIn(false);\r\n            }}\r\n          >\r\n            Kijelentkezés\r\n          </button>\r\n          <button onClick={() => setIsPrefOpen(true)}>Beállítások...</button>\r\n          <ReactModal\r\n            isOpen={isPrefOpen}\r\n            className=\"prefModal\"\r\n            appElement={document.getElementById(\"App\")!}\r\n          >\r\n            <div className=\"prefModalContainer\">\r\n              <div>\r\n                <p>Témaválasztás:</p>\r\n                <br />\r\n                <p>MIDI Clip színe:</p>\r\n                <br />\r\n                <p>MIDI jel színe:</p>\r\n              </div>\r\n              <div>\r\n                <select defaultValue=\"darkMode\" ref={prefThemeRef}>\r\n                  <option value=\"darkMode\">Sötét</option>\r\n                  <option value=\"darkModeBlue\">Sötét kék</option>\r\n                  <option value=\"fade\">Átmenetes 1</option>\r\n                  <option value=\"fadeFire\">Átmenetes 2</option>\r\n                  <option value=\"warm\">Narancs</option>\r\n                </select>\r\n                <br />\r\n                <input type=\"color\" ref={prefMidiClipColor} />\r\n                <br />\r\n                <input type=\"color\" ref={prefMidiNoteColor} />\r\n              </div>\r\n            </div>\r\n            <button\r\n              className=\"prefModalCancelButton\"\r\n              onClick={() => setIsPrefOpen(false)}\r\n            >\r\n              Mégsem\r\n            </button>\r\n            <button\r\n              className=\"prefModalSaveButton\"\r\n              onClick={() => {\r\n                const root = document.documentElement;\r\n                switch (prefThemeRef.current!.value) {\r\n                  case \"darkMode\":\r\n                    root.style.setProperty(\r\n                      \"--main-bg-color\",\r\n                      \"rgb(40, 40, 40)\"\r\n                    );\r\n                    root.style.setProperty(\r\n                      \"--modal-bg-color\",\r\n                      \"rgb(40, 40, 40)\"\r\n                    );\r\n                    break;\r\n                  case \"darkModeBlue\":\r\n                    root.style.setProperty(\"--main-bg-color\", \"rgb(0, 0, 26)\");\r\n                    root.style.setProperty(\"--modal-bg-color\", \"rgb(0, 0, 26)\");\r\n                    break;\r\n                  case \"warm\":\r\n                    root.style.setProperty(\r\n                      \"--main-bg-color\",\r\n                      \"rgb(255, 102, 0)\"\r\n                    );\r\n                    root.style.setProperty(\r\n                      \"--modal-bg-color\",\r\n                      \"rgb(255, 102, 0)\"\r\n                    );\r\n                    break;\r\n                  case \"fadeFire\":\r\n                    root.style.setProperty(\r\n                      \"--main-bg-color\",\r\n                      \"linear-gradient(90deg, rgb(255, 102, 0) 0%, rgb(204, 0, 0) 100%)\"\r\n                    );\r\n                    root.style.setProperty(\r\n                      \"--modal-bg-color\",\r\n                      \"linear-gradient(90deg, rgb(255, 102, 0) 0%, rgb(204, 0, 0) 100%)\"\r\n                    );\r\n                    break;\r\n                  case \"fade\":\r\n                    root.style.setProperty(\r\n                      \"--main-bg-color\",\r\n                      \"linear-gradient(90deg, rgb(12, 38, 167) 0%, rgb(180, 33, 62) 100%)\"\r\n                    );\r\n                    root.style.setProperty(\r\n                      \"--modal-bg-color\",\r\n                      \"linear-gradient(90deg, rgb(12, 38, 167) 0%, rgb(180, 33, 62) 100%)\"\r\n                    );\r\n                    break;\r\n\r\n                  default:\r\n                    throw Error(\"Unknown theme!\");\r\n                }\r\n\r\n                appStore\r\n                  .collection(\"users\")\r\n                  .doc(appAuth.currentUser!.uid)\r\n                  .set({\r\n                    theme: prefThemeRef.current!.value,\r\n                    midiClipColor: prefMidiClipColor.current!.value,\r\n                    midiNoteColor: prefMidiNoteColor.current!.value,\r\n                  })\r\n                  .catch((error) => {\r\n                    alert(\r\n                      \"Beállítások elmentésekor valamilyen hiba lépett fel!\"\r\n                    );\r\n                    console.log(error);\r\n                  });\r\n\r\n                dispatch(changeMidiClipColor(prefMidiClipColor.current!.value));\r\n                dispatch(changeMidiNoteColor(prefMidiNoteColor.current!.value));\r\n\r\n                // TODO: firestorera elmentés\r\n                setIsPrefOpen(false);\r\n              }}\r\n            >\r\n              Mentés\r\n            </button>\r\n          </ReactModal>\r\n        </>\r\n      ) : (\r\n        <>\r\n          <button onClick={() => setIsSignInOpen(true)}>Belépés</button>\r\n          <ReactModal\r\n            isOpen={isSignInOpen}\r\n            className=\"signInModal\"\r\n            appElement={document.getElementById(\"App\")!}\r\n          >\r\n            <div className=\"signInContainer\">\r\n              <div>\r\n                <p>Email</p>\r\n                <p>Jelszó</p>\r\n              </div>\r\n              <div>\r\n                <input type=\"text\" ref={signInEmailRef} />\r\n                <input type=\"password\" ref={signInPasswordRef} />\r\n              </div>\r\n            </div>\r\n            <button\r\n              className=\"signUpModalCancelButton\"\r\n              onClick={() => setIsSignInOpen(false)}\r\n            >\r\n              Mégsem\r\n            </button>\r\n            <button\r\n              className=\"signUpModalSignUpButton\"\r\n              onClick={() => {\r\n                appAuth //(\"dfgsdfg@sdfasdf.asdf\", \"123456\")\r\n                  .signInWithEmailAndPassword(\r\n                    signInEmailRef.current!.value,\r\n                    signInPasswordRef.current!.value\r\n                  )\r\n                  .then((cred) => {\r\n                    setIsLoggedIn(true);\r\n                    setIsSignInOpen(false);\r\n                    appStore\r\n                      .collection(\"users\")\r\n                      .doc(cred.user!.uid)\r\n                      .get()\r\n                      .then((doc) => {\r\n                        const root = document.documentElement;\r\n                        switch (doc.data()!.theme) {\r\n                          case \"darkMode\":\r\n                            root.style.setProperty(\r\n                              \"--main-bg-color\",\r\n                              \"rgb(40, 40, 40)\"\r\n                            );\r\n                            root.style.setProperty(\r\n                              \"--modal-bg-color\",\r\n                              \"rgb(40, 40, 40)\"\r\n                            );\r\n                            break;\r\n                          case \"fade\":\r\n                            root.style.setProperty(\r\n                              \"--main-bg-color\",\r\n                              \"linear-gradient(90deg, rgb(12, 38, 167) 0%, rgb(180, 33, 62) 100%)\"\r\n                            );\r\n                            root.style.setProperty(\r\n                              \"--modal-bg-color\",\r\n                              \"linear-gradient(90deg, rgb(12, 38, 167) 0%, rgb(180, 33, 62) 100%)\"\r\n                            );\r\n                            break;\r\n                          case \"darkModeBlue\":\r\n                            root.style.setProperty(\r\n                              \"--main-bg-color\",\r\n                              \"rgb(0, 0, 26)\"\r\n                            );\r\n                            root.style.setProperty(\r\n                              \"--modal-bg-color\",\r\n                              \"rgb(0, 0, 26)\"\r\n                            );\r\n                            break;\r\n                          case \"warm\":\r\n                            root.style.setProperty(\r\n                              \"--main-bg-color\",\r\n                              \"rgb(255, 102, 0)\"\r\n                            );\r\n                            root.style.setProperty(\r\n                              \"--modal-bg-color\",\r\n                              \"rgb(255, 102, 0)\"\r\n                            );\r\n                            break;\r\n                          case \"fadeFire\":\r\n                            root.style.setProperty(\r\n                              \"--main-bg-color\",\r\n                              \"linear-gradient(90deg, rgb(255, 102, 0) 0%, rgb(204, 0, 0) 100%)\"\r\n                            );\r\n                            root.style.setProperty(\r\n                              \"--modal-bg-color\",\r\n                              \"linear-gradient(90deg, rgb(255, 102, 0) 0%, rgb(204, 0, 0) 100%)\"\r\n                            );\r\n                            break;\r\n\r\n                          default:\r\n                            alert(\"Hiba történt a háttér betöltésekor!\");\r\n                            break;\r\n                        }\r\n\r\n                        dispatch(\r\n                          changeMidiClipColor(doc.data()!.midiClipColor)\r\n                        );\r\n                        dispatch(\r\n                          changeMidiNoteColor(doc.data()!.midiNoteColor)\r\n                        );\r\n                      })\r\n                      .catch((error) => {\r\n                        alert(\"Hiba történt a beállítások betöltésekor!\");\r\n                        console.log(error);\r\n                      });\r\n                  })\r\n                  .catch((error) => {\r\n                    if (error.code === \"auth/user-not-found\") {\r\n                      alert(\"A megadott email címhez nem tartozik fiók!\");\r\n                    } else if (error.code === \"auth/wrong-password\") {\r\n                      alert(\"A megadott jelszó nem helyes!\");\r\n                    } else {\r\n                      alert(error.code);\r\n                      console.log(error);\r\n                    }\r\n                  });\r\n              }}\r\n            >\r\n              Belépés\r\n            </button>\r\n          </ReactModal>\r\n          <button onClick={() => setIsSignUpOpen(true)}>Regisztráció</button>\r\n          <ReactModal\r\n            isOpen={isSignUpOpen}\r\n            className=\"signUpModal\"\r\n            appElement={document.getElementById(\"App\")!}\r\n          >\r\n            <div className=\"signUpContainer\">\r\n              <div>\r\n                <p>Email</p>\r\n                {/* <p>Név</p> */}\r\n                <p>Jelszó</p>\r\n                <p>Jelszó megerősítése</p>\r\n              </div>\r\n              <div>\r\n                <input\r\n                  id=\"email\"\r\n                  type=\"email\"\r\n                  autoComplete=\"off\"\r\n                  required={true}\r\n                  ref={emailRef}\r\n                />\r\n                {/* <input\r\n                  id=\"name\"\r\n                  type=\"text\"\r\n                  autoComplete=\"off\"\r\n                  required={true}\r\n                  ref={nameRef}\r\n                  maxLength={20}\r\n                  minLength={5}\r\n                /> */}\r\n                <input\r\n                  id=\"password\"\r\n                  type=\"password\"\r\n                  autoComplete=\"off\"\r\n                  required={true}\r\n                  ref={passwordRef}\r\n                  maxLength={15}\r\n                  minLength={5}\r\n                />\r\n                <input\r\n                  id=\"password-confirm\"\r\n                  type=\"password\"\r\n                  autoComplete=\"off\"\r\n                  required={true}\r\n                  ref={passwordConfirmRef}\r\n                  maxLength={15}\r\n                  minLength={5}\r\n                />\r\n              </div>\r\n            </div>\r\n            <button\r\n              className=\"signUpModalCancelButton\"\r\n              onClick={() => setIsSignUpOpen(false)}\r\n            >\r\n              Mégsem\r\n            </button>\r\n            <button\r\n              className=\"signUpModalSignUpButton\"\r\n              onClick={() => {\r\n                if (\r\n                  checkSignUpCredentials(\r\n                    emailRef,\r\n                    // nameRef,\r\n                    passwordRef,\r\n                    passwordConfirmRef\r\n                  )\r\n                ) {\r\n                  appAuth\r\n                    .createUserWithEmailAndPassword(\r\n                      emailRef.current!.value,\r\n                      passwordRef.current!.value\r\n                    )\r\n                    .then((cred) => {\r\n                      appStore.collection(\"users\").doc(cred.user!.uid).set({\r\n                        theme: \"darkMode\",\r\n                        midiClipColor: \"grey\",\r\n                        midiNoteColor: \"#6fff00\",\r\n                      });\r\n                    })\r\n                    .catch((error) => {\r\n                      if (error.code === \"auth/email-already-in-use\") {\r\n                        alert(\"Az email címhez már tartozik egy fiók!\");\r\n                      } else {\r\n                        alert(error.message);\r\n                      }\r\n                    });\r\n                  setIsSignUpOpen(false);\r\n                }\r\n              }}\r\n            >\r\n              Regisztráció\r\n            </button>\r\n          </ReactModal>\r\n        </>\r\n      )}\r\n\r\n      {/* <button>Sign up</button> */}\r\n      <div className=\"footerRightButtons\">\r\n        <button onClick={() => dispatch(exportProject())}>Exportálás...</button>\r\n        <button\r\n          onClick={() => {\r\n            const fileSelector = document.createElement(\"input\");\r\n            fileSelector.type = \"file\";\r\n            fileSelector.accept = \".sudden\";\r\n\r\n            fileSelector.onchange = (e: Event) => {\r\n              if (\r\n                (e.target as HTMLInputElement).files &&\r\n                (e.target as HTMLInputElement).files!.length\r\n              ) {\r\n                const file = (e.target as HTMLInputElement).files![0];\r\n                const fileReader = new FileReader();\r\n\r\n                if (!file.name.endsWith(\".sudden\")) {\r\n                  alert(\r\n                    \"A file típusa nem megfelelő, kérlek ellenőrizd, hogy a megfelelőt nyitottad-e meg!\"\r\n                  );\r\n                }\r\n\r\n                fileReader.onloadend = (e) => {\r\n                  const content = fileReader.result;\r\n\r\n                  if (content === undefined || content === null) {\r\n                    alert(\r\n                      \"Valami hiba keletkezett a projekt beimportálásakor!\"\r\n                    );\r\n                    return;\r\n                  }\r\n\r\n                  // Check if content is fine\r\n                  const fileParts = content.toString().split(\"\\n\");\r\n\r\n                  if (fileParts.length !== 4) {\r\n                    // throw Error(\r\n                    //   \"File has been modified and cannot import it...\"\r\n                    // );\r\n                    alert(\"Nem importálható a fájl!\");\r\n                    return;\r\n                  }\r\n\r\n                  const importedBPM = +fileParts[3];\r\n                  // console.log(importedBPM);\r\n\r\n                  if (\r\n                    isNaN(importedBPM) ||\r\n                    Math.trunc(importedBPM) !== importedBPM ||\r\n                    importedBPM < 40 ||\r\n                    importedBPM > 250\r\n                  ) {\r\n                    alert(\"Nem importálható a fájl!\");\r\n                    return;\r\n                  }\r\n\r\n                  const projectToImport = fileParts[2];\r\n\r\n                  try {\r\n                    const parsedJSON: any = JSON.parse(projectToImport);\r\n\r\n                    if (!isValidProject(parsedJSON)) {\r\n                      alert(\"Nem importálható a fájl!\");\r\n                      return;\r\n                    }\r\n\r\n                    //console.log(parsedJSON);\r\n                    dispatch(clearEveryTrack());\r\n                    dispatch(importProject(parsedJSON));\r\n                    dispatch(setImportedBPM(importedBPM));\r\n                  } catch (e) {\r\n                    // throw Error(\r\n                    //   \"Cannot parse JSON file, probably due to unwanted modifications to the file...\"\r\n                    // );\r\n                    alert(\"Hiba történt az importáláskor!\");\r\n                    return;\r\n                  }\r\n                };\r\n\r\n                fileReader.readAsText(file);\r\n              }\r\n            };\r\n            fileSelector.click();\r\n          }}\r\n        >\r\n          Importálás...\r\n        </button>\r\n      </div>\r\n    </footer>\r\n  );\r\n}\r\n\r\nexport default Footer;\r\n\r\nfunction isValidProject(parsedJSON: any) {\r\n  return (parsedJSON as TrackInterface[]).every((track) => {\r\n    return (\r\n      \"dataKey\" in track &&\r\n      \"name\" in track &&\r\n      \"instrument\" in track &&\r\n      \"midiClips\" in track &&\r\n      \"isMuted\" in track\r\n    );\r\n  });\r\n}\r\n","import React from \"react\";\r\nimport \"./Header.css\";\r\n\r\nfunction Header() {\r\n  return <header id=\"header\">Sudden Music</header>;\r\n}\r\n\r\nexport default Header;\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAYAAAD0eNT6AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABEcSURBVHhe7d3RbhzHEQVQWyRtOAYMJP//jQEMBEaAmFJmtE2LprjLnd2Z7qquc1448xYb8dzbVU3pxx8K+rJoj7v6cdEeASC0MoF1VOhfohAAENXUATUi9M9RBgCIZMpQihT871EGABhtqiCKHvzvUQYAGGGK8MkY/O9RBgDoJXvgfFqy/7k9T0MRAOBoaYNmllP/JYoAAEdJGTAVwv81RQCAvX1qP7P4uVr4r9Z/5lV7BYC7ZTpZ/rJk4B/tuTQTAQDulWUC8Kvw/6ZNA5QAAG6WIUR+W/Lu9/bMG6YBANwienj8cwn/f7dnLlAEANgicmg8LOH/Z3vmSooAANcIGxZtz80Nlg6w3u3w7w+As0IWAOG/D9MAAM4JFxDCf3+KAABvRfs1wMf2kx2tpWrVXgEg1gRASB3PNACAVZgwEP59KQIAtSkAxSkCADWF+PgL//EUAYBasv1tgBxECQOoZfipT/DEYxoAML/REwATiIDWUrZqrwBMaOhJT8jkYCIAMB8ncD6kqAHMZ9jJTqjkZBoAMAcFgJsoAgC5DfmIC/95KAIAObkDwF2UOYCcTADYjWkAQB7dP9jCf36KAEB8VgDsrpW8p9MbABGZAHAo0wCAmBQAulAEAGLp+lEW/igCADG4A0BXrQQ+nt4AGMUEgGFMAwDGUQAYThEA6K/bh1f48xFFAKAfdwAIo5XEh9MbAEcyASAk0wCAYykAhKYIABxDASAFRQBgX+4AkEIrkP7/CrCTLqcqp3/2ZBoAcD8FgLQUAYDbKQCkpwgAbGenSnqtYCoBABuYADAV0wCA6ygATEkRALhMAWBqigDA+9wBYGqtfCoBAG+YAFCGaQDANwoA5SgCAAoAhSkCQGXuAFCWYgpUZgIAC9MAoBoFAF5RBIAqFAB4hyIAzM4dAHiH0grMzgQAPmAaAMxIAYArKQLATBQA2EgRAGbgDgBspNACMzABgDuYBgBZKQCwA0UAyEYBgB0pAkAW7gDAjpRdIAsTADiIaQAQmQIAB1MEgIisAOBgrQA/nd4AYjABgI5MA4AoFAAYQBEARlMAYCBFABjFHQAYqJXjx9MbQD8mABCEaQDQkwIAwSgCQA8KAASlCABHcgcAgmrF+eH0BrAvEwBIwDQA2JsCAIkoAsBeFABISBEA7uUOACTUSrX/foGbmQBAcqYBwC0UAJiEIgBsoQDAZBQB4Bp2iDCZVrj9tw1cZAIAEzMNAM5RAKAARQB4SwGAQhQB4IU9IRTSyrgSAJgAQFWmAVCbAgDFKQJQkwIAfKUIQC3uAABfKepQiwkA8B3TAJifAgCcpQjAvBQA4EOKAMzHHQDgQ0o8zMcEANjENADmoAAAN1EEIDcFALiLIgA5uQMA3EXBh5xMAIDdmAZAHgoAsDtFAOJTAIDDKAIQlzsAwGGUf4jLBADowjQAYlEAgK4UAYhBAQCGUARgLHcAgCEcDGAsEwBgONMA6E8BAMJQBKAfKwAgjHZYeDy9AUcyAQBCMg2AYykAQGiKABxDAQBSUARgX+4AACm0g8TD6Q24lwkAkI5pANxPAQDSUgTgdgoAkJ4iANu5AwCk1w4ZvmewgQkAMBXTALiOAgBMSRGAyxQAYGqKALzPzgyYWjuA+NbBGyYAQBmmAfCNAgCUowiAAgAUpghQmb0YUFY7nCgBlGQCALAwDaAaBQDgFUWAKhQAgHcoAszOHQCAd7SDixLAtEwAAD5gGsCMFACAKykCzEQBANhIEWAG7gAAbORQwwxMAADuYBpAVgoAwA4UAbJRAAB2pAiQhTsAADty4CELEwCAg5gGEJkCAHAwRYCIFACAThQBInEHAKAThyEiMQEAGMA0gNEUAICBFAFGUQAAAlAE6M0dAIAAHJTozQQAIBjTAHpQAACCUgQ4khUAQFDt8PR4eoN9mQAAJGAawN4UAIBEFAH2ogAAJKQIcC93AAASagerh9MbbGcCAJCcaQC3UAAAJqEIsIUCADAZRYBruAMAMJl26PJ95yITAICJmQZwjgIAUIAiwFsKAEAhigAv7IgACmkHMt9+TAAAqjINqE0BAChOEahJAQDgK0WgFnsgAL5qhzUloAgTAAC+YxowPwUAgLMUgXkpAAB8SBGYjzsAAHyoHeSUgImYAACwiWnAHBQAAG6iCOSmAABwF0UgJ3cAALiLQ15OJgAA7MY0IA8FAIDdKQLxKQAAHEYRiMsdAAAO4wAYlwkAAF2YBsSiAADQlSIQgwIAwBCKwFjuAAAwhMPhWCYAAAxnGtCfAgBAGIpAPwoAAOEoAsdzBwCAcBwcj2cCAEBopgHHUAAASEER2JcVAAAptMPk4+mNe5kAAJCOacD9FAAA0lIEbqcAAJCeIrCdOwAApNcOmg+nN65hAgDAVEwDrqMAADAlReAyBQCAqSkC73MHAICptUOo+wFvmAAAUIZpwDcKAADlKAIKAACFVS4C7gAAUFY7oJbMQhMAAFhUmwYoAADwSpUiYAUAAK9UObSaAADAGTNPA0wAAOCMdoB9PL3NxQQAAK4w2zTABAAArtAOs9PkpgkAAGw0wzTABAAANprhYKsAAMANspcABQAAbtRKwC+nt1zcAQCAHWS7F2ACAAA7yHbYVQAAYCeZSoACAAA7ylICFAAA2FmGEqAAAMABopcABQAADhK5BCgAAHCgqCVAAQCA44X7K4X9QUAA0EG0PyjIBAAAOoh2GFYAAKCTSCVAAQCAjqKUAAUAAApSAACgswhTAAUAAMZ4aj+H8GuAADDIyF8NNAEAgEFGHpAVAAAoSAEAgIFGTQEUAAAoSAEAgMFGTAEUAAAoSAEAgIIUAAAIoPcaQAEAgIIUAAAIoucUQAEAgIIUAAAoSAEAgIIUAAAIpNc9AAUAAApSAACgIAUAAApSAACgIAUAAApSAACgIAUAAApSAACgIAUAAApSAACgIAUAAApSAACgIAUAAApSAACgIAUAAApSAAAgkB8X7fFQCgAAFKQAAEBBCgAAFKQAAEAQvfb/KwUAAApSAAAggJ6n/5UCAAAFKQAAUJACAACD9R7/rxQAAChIAQCAgUac/lcKAAAUpAAAwCCjTv8rBQAABliy/6f2OIQCAABj/K/9HEIBAIDORo7+XygAAFCQAgAAHUU4/a8UAADoJEr4rxQAAOggUvivFAAAONiS/U/tMQwFAACO92f7GYYCAAAHijb6f6EAAMBBoob/SgEAgANEDv+VAgAAO4se/isFAAB2lCH8VwoAAOwkS/ivFAAA2EGm8F8pAABwhyX3/5Et/Fdd/gd/WbRHAJhGxuB/YQIAADfIHP4rBQAANsoe/isFAACutOT+wwzhv1IAAOAKLfg/n97yUwAA4IIl959mOfW/1uUfyG8BAJDRjMH/QgEAgDdmDv4XVgAA8EqF8F+ZAADAokrwvzABAKC0Jfen+dW+LRQAAMpqwT/Nr/ZtYQUAQDkVT/xvKQAAlCH4v7ECAGB6S+4/Cv+/UwAAmFoL/ufTGy+sAACYkhP/ZQoAAFMR/NexAgBgCkvu2/NvoAAAkF4Lfnv+DawAAEjLif92CgAA6Qj++1kBAJDGkvtPwn8fJgAApCD496UAABCa4D+GAgBASIL/WO4AABCO8D+eCQAAYQj+fhQAAIYT/P0pAAAMI/jHcQcAgCGE/1gmAAB0JfhjUAAA6ELwx6IAAHAowR+TOwAAHEb4x2UCAMDuBH98CgAAuxH8eSgAANxN8OfjDgAAdxH+OZkAAHATwZ+bAgDAJoJ/DlYAAFxlyf1Pwn8eCgAAH2rBb5o7ESsAAM5y4p+XAgDAdwT//KwAAPjLkvv2/EUoAAB81YLfxLYIKwCA4pz4a1IAAIoS/LVZAQAUs+T+g/BHAQAopAX/59MblVkBABTgxM9bCgDAxAQ/51gBAExoyX17fi5SAAAm04Lfnp+LrAAAJuHEzxYKAEBygp9bWAEAJLXk/qPw51YKAEBCLfifT2+wnRUAQCJO/OxFAQBIQPCzNysAgMCW3H8S/hzBBAAgKMHPkRQAgGAEPz0oAABBCH56cgcAIADhT28mAAADCX5GUQAABhD8jKYAAHQk+InCHQCAToQ/kZgAABxM8BORAgBwEMFPZAoAwM4EPxm4AwCwI+FPFiYAADsQ/GSjAADcQfCTlQIAcAPBT3buAABsJPyZgQkAwJUEPzNRAAA+IPiZkRUAwBlL7n8S/sxKAQB4Rwt+00umZQUA8IoTP1UoAAALwU81VgBAaUvu2/NTkgIAlNWC34SSkqwAgHKc+EEBAAoR/PCNFQAwvSX3H4Q//J0CAEytBf/n0xvwwgoAmJITP1ymAABTEfxwHSsAYApL7tvzwwYKAJBeC357ftjACgBIy4kfbqcAAOkIfrifFQCQxpL7j8If9qEAACm04H8+vQH3sgIAQnPih2MoAEBIgh+OZQUAhLLk/pPwh+OZAABhCH7oRwEAhhP80J8CAAwj+GEcdwCAIYQ/jGUCAHQl+CEGBQDoQvBDLAoAcCjBDzG5AwAcRvhDXCYAwO4EP8SnAAC7EfyQhwIA3E3wQz7uAAB3Ef6QkwkAcBPBD7kpAMAmgh/moAAAVxH8MBd3AIAPCX+YjwkAcJbgh3kpAMB3BD/MTwEA/iL4oQ53AICvhD/UYgIAxQl+qEkBgKIEP9RmBQDFLLn/SfgDCgAU0oLfRA6wAoAKnPiBtxQAmJjgB86xAoAJLbn/IPyBSxQAmEwL/s+nN4D3WQHAJJz4gS0UAEhO8AO3sAKApJbct+cHbqYAQEIt+O35gZtZAUAiTvzAXhQASEDwA3uzAoDAltx/FP7AERQACKoF//PpDWBfVgAQjBM/0IMCAEEIfqAnKwAYbMn9J+EP9GYCAAMJfmAUBQAGEPzAaAoAdCT4gSjcAYAOltz/SfgDkZgAwMEEPxCRAgAHEfxAZAoA7EzwAxm4AwA7Ev5AFiYAsAPBD2SjAMAdBD+QlQIANxD8QHbuAMBGwh+YgQkAXEnwAzNRAOADgh+YkQIAZwh+YGbuAMA7hD8wOxMAeEXwA1UoALAQ/EA1CgClCX6gKncAKEv4A5WZAFCO4AdQAChE8AN8YwXA9Jbc/yT8Af5OAWBqLfhNoADesAJgSk78AJcpAExF8ANcxwqAKSy5b88PsIECQHot+E2ZADawAiAtJ36A2ykApCP4Ae7X7UOqBHCvJfcflh+fT28A3MMdAFJop37hD7ATEwBCM+4HOIYCQEiCH+BYVgCEsuT+o/AHOJ4CQBgt+J9PbwAcqetJyxqA9zjxA/SnADCM4AcYxwqA7pbcfxL+AGOZANCV4AeIofvHWAmoSfADxKIAcCjBDxCTOwAcYsn9n4Q/QFwmAOxO8APEN+RDrQTMSfAD5KEAcDfBD5CPOwDcRfgD5DTs420KkJvgB8hNAWATwQ8wh6EfcyUgD8EPMBd3APiQ8AeYz+gP+6cvX774+9+DEvwA8xr+gbcGiEfwA8wvxIdeCYhB8APU4Q4AXwl/gFrCfPRNAcYQ/AA1KQBFCX6A2kKFgBJwPMEPwCrUHYAlm57aIwcQ/gC8CBcIpgD7E/wAvBUyGJSAfQh+AM4JGxBKwO2W3F9XO/79AXBW2D8HYAmxx/bIBu3UL/wBuCjyHwT0vGTZv9ozH1iDf9VeAeCiDIHx25cvX35vz7wh9AG4RZbw+HUpAf9pzyyW3LfnB+BmmU6Pvywl4I/2XJpTPwD3yhYkPy8l4L/tuRzBD8BeUgbKUgJKjb4FPwB7SxssFUqA4AfgKNkD5tPSA57b8zQEPwBHmyJoZpkGCH4AepkqcDIWAaEPwAhThk/0IiD0ARht6iCKVASEPgCRlAmlEWVA6AMQVcmAOqoMCHwAcvjhh/8DEMsepAKDSi8AAAAASUVORK5CYII=\"","import React, { useEffect, useRef } from \"react\";\r\nimport * as Tone from \"tone\";\r\nimport \"./NavigationBar.css\";\r\nimport playButton from \"../Icons/playButton.png\";\r\nimport stopButton from \"../Icons/stopButton.png\";\r\nimport pauseButton from \"../Icons/pauseButton.png\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n  changeArrViewGridPadding,\r\n  changeArrViewNumOfPhrases,\r\n  clearImportedBPM,\r\n} from \"../Actions\";\r\nimport { Rootstate } from \"../Interfaces\";\r\n\r\nfunction togglePlay(\r\n  buttonRef: React.RefObject<HTMLImageElement>,\r\n  curTransportPosition: number\r\n) {\r\n  if (Tone.Transport.state === \"stopped\") {\r\n    buttonRef.current!.src = stopButton;\r\n    Tone.start();\r\n    Tone.Transport.start(\"+0.1\", `${curTransportPosition}i`);\r\n    // console.log(\"Started Transport\");\r\n  } else {\r\n    buttonRef.current!.src = playButton;\r\n    Tone.Transport.stop();\r\n    // console.log(\"Stopped Transport\");\r\n  }\r\n}\r\n\r\nfunction togglePause() {\r\n  if (Tone.Transport.state === \"started\") {\r\n    // console.log(\"Paused Transport\");\r\n    Tone.Transport.pause();\r\n  } else if (Tone.Transport.state === \"paused\") {\r\n    // console.log(\"Unpaused Transport\");\r\n    Tone.Transport.start();\r\n  }\r\n}\r\n\r\nfunction changeBPM(BPMInputRef: React.RefObject<HTMLInputElement>) {\r\n  if (!/^\\d+$/.test(BPMInputRef.current!.value)) {\r\n    alert(\"A BPM csak számokat tartalmazhat!\");\r\n    BPMInputRef.current!.value = \"120\";\r\n    return;\r\n  }\r\n\r\n  const newBPMValue = +BPMInputRef.current!.value;\r\n\r\n  if (newBPMValue === Tone.Transport.bpm.value) {\r\n    return;\r\n  }\r\n\r\n  if (newBPMValue > 250) {\r\n    BPMInputRef.current!.value = \"250\";\r\n    alert(\"A BPM értéke nem lehet nagyobb 250-nél!\");\r\n    return;\r\n  }\r\n\r\n  if (newBPMValue < 40) {\r\n    BPMInputRef.current!.value = \"40\";\r\n    alert(\"A BPM értéke nem lehet kisebb 40-nél!\");\r\n    return;\r\n  }\r\n\r\n  if (newBPMValue !== Math.trunc(newBPMValue)) {\r\n    BPMInputRef.current!.value = Math.trunc(newBPMValue).toString();\r\n    alert(\"A BPM értéke csak egész szám lehet!\");\r\n    Tone.Transport.bpm.value = Math.trunc(newBPMValue);\r\n    return;\r\n  }\r\n\r\n  Tone.Transport.bpm.value = newBPMValue;\r\n}\r\n\r\nfunction NavigationBar() {\r\n  const dispatch = useDispatch();\r\n\r\n  // console.log(\"IN NAV\");\r\n\r\n  const curTransportPosition = useSelector(\r\n    (state: Rootstate) => state.curTransportPosition\r\n  );\r\n\r\n  const importedBPM = useSelector(\r\n    (state: Rootstate) => state.importedProps.BPM\r\n  );\r\n\r\n  const playStopButtonRef = useRef<HTMLImageElement>(null);\r\n  const BPMInputRef = useRef<HTMLInputElement>(null);\r\n\r\n  // useEffect(() => {\r\n  //   document.onkeydown = (e) => {\r\n  //     if (e.key === \" \") {\r\n  //       e.preventDefault();\r\n  //       e.stopPropagation();\r\n  //       togglePlay(playStopButtonRef, curTransportPosition);\r\n  //     }\r\n  //   };\r\n  // }, [curTransportPosition]);\r\n\r\n  useEffect(() => {\r\n    if (importedBPM === -1) {\r\n      return;\r\n    }\r\n\r\n    if (BPMInputRef === null) {\r\n      return;\r\n    }\r\n\r\n    BPMInputRef.current!.value = importedBPM.toString();\r\n    Tone.Transport.bpm.value = importedBPM;\r\n\r\n    dispatch(clearImportedBPM());\r\n  }, [importedBPM, dispatch]);\r\n\r\n  return (\r\n    <nav>\r\n      <button\r\n        onClick={() => togglePlay(playStopButtonRef, curTransportPosition)}\r\n      >\r\n        <img src={playButton} alt=\"Play\" width=\"10px\" ref={playStopButtonRef} />\r\n      </button>\r\n      <button onClick={() => togglePause()}>\r\n        <img src={pauseButton} alt=\"Pause\" width=\"10px\" />\r\n      </button>\r\n      <span>BPM:</span>\r\n      <input\r\n        type=\"number\"\r\n        id=\"BPMInput\"\r\n        ref={BPMInputRef}\r\n        min={40}\r\n        max={250}\r\n        defaultValue={120}\r\n        onKeyUp={(e) => e.key === \"Enter\" && changeBPM(BPMInputRef)}\r\n        onBlur={() => changeBPM(BPMInputRef)}\r\n      />\r\n      <span>Félperiódusok száma:</span>\r\n      <select\r\n        defaultValue=\"4\"\r\n        onChange={(e) => {\r\n          if (Tone.Transport.state === \"started\") {\r\n            togglePlay(playStopButtonRef, curTransportPosition);\r\n          }\r\n          dispatch(changeArrViewNumOfPhrases(+e.target.value));\r\n        }}\r\n      >\r\n        <option value=\"1\">1</option>\r\n        <option value=\"2\">2</option>\r\n        <option value=\"4\">4</option>\r\n        <option value=\"8\">8</option>\r\n        <option value=\"16\">16</option>\r\n        <option value=\"32\">32</option>\r\n      </select>\r\n      <span>Rácsok sűrűsége:</span>\r\n      <select\r\n        defaultValue=\"16\"\r\n        onChange={(e) => {\r\n          if (Tone.Transport.state === \"started\") {\r\n            togglePlay(playStopButtonRef, curTransportPosition);\r\n          }\r\n          dispatch(changeArrViewGridPadding(+e.target.value));\r\n        }}\r\n      >\r\n        <option value=\"4\">4</option>\r\n        <option value=\"8\">8</option>\r\n        <option value=\"16\">16</option>\r\n        <option value=\"32\">32</option>\r\n        <option value=\"64\">64</option>\r\n      </select>\r\n    </nav>\r\n  );\r\n}\r\n\r\nexport default NavigationBar;\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAYAAAD0eNT6AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAw+SURBVHhe7d3ddttkGkBh0nY6QBcz3P+NDrBaOvoamRVC0vhHtiXt5znA8kETOyfv1ivZPPzAq75O5kMANuhhMh/yjD/MzLAHaBAFj7J/BAMfgKEaBJk3beADcIxKEOz+TRr8AJxrzzGwyzdm6AOwpD2GwG7ekKEPwC3sJQY2/yYMfgDuYeshsNkXb/ADsAZbDYHNvWiDH4A12loIvJsft+C94Q/AWs0z6uPjs/XbRK0Y/ABsyRa2Aat+gQY/AFu25hBY6yWAB8MfgK2bZ9kqZ+3qysTgB2CP1rYNWNWLMfwB2LM1RcBa1hI/Gv4A7N08635+fHZfdy8Rgx+AontvA+76yw1/AMruGQH3ugTwzvAHoG6ehe8fn93WPQLg4/R+v8zHAJA2zcTP08OPj89u59YB8Mv0Rn+fjwGAyTQb/zc9/Pfx2W3c7NrD9Oas/AHgDbe6L+Amv8TwB4Dj3SICrv4LDH8AON21I+CqP9zwB4DzXTMCrvaDDX8AuNy1IuBanwL4ZX4EAC5zlU8HXKMqxuf8fdQPABby8PDw0/Tw2+OzZSwdAOMb/nzJDwAsbIqAD9PDYjN20QBw3R8ArmfJ+wEW+0GGPwBc31IRsMgPMfwB4HaWiIAlPgUwbkwAAG7n0/x4tosLwtk/ANzepVuAi/6x4Q8A93NJBJz9Dw1/ALi/cyPg3HsArvUNggDAacb3A5zsrGpw9g8A63HOFuDkf2D4A8D6nBoBVvkAEHRSLTj7B4D1OmULcMoG4P38CACs0Ckn6kcHwPQzP8+HAMDGHbUqsPoHgO045lKAmwABIOjNQnD2DwDb89YWwAYAAIK+WwfO/gFgu763BbABAICgV8vA2T8AbN9rWwAbAAAIEgAAEPTiWsD6HwD246XLADYAABD0jyJw9g8A+/N8C2ADAABBAgAAgv62DrD+B4D9enoZwAYAAIIEAAAECQAACPrrWoDr/wCwf4f7AGwAACBIAABAkAAAgKBv1wFc/weAjnEfgA0AAAQJAAAIEgAAECQAACDowQ2AANBjAwAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQ/jP18n354BALv3MLEBAIAgAQAAQQIAAIIEAAAEfbsJcHAjIADs37gBcDzaAABAkAAAgCABAABBf90DMLgPAAD263D9f7ABAIAgAQAAQQIAAIL+dg/A4D4AANifp9f/BxsAAAgSAAAQ9I9LAIPLAACwH8/X/4MNAAAEvbgBGGwBAGD7Xjr7H2wAACBIAABA0KuXAAaXAQBgu15b/w82AAAQ9N0NwGALAADb872z/8EGAACC3twADLYAALAdb539DzYAABB01AZgsAUAgPU75ux/OHoDMP28D/MhALBC06z+OB++6egNwGALAADrdezZ/3BSAAwiAADW55ThP7gJEACCTt4ADLYAALAep579D2dtAKbf834+BADuaJrJZ92kf+4lgD/nRwDgvr7Mjyc56xLAgUsBAHA/56z+Dy4KgEEEAMDtXTL8h4s/BTD9/p/nQwDgBqbZ+2k+PNvFG4DBFgAAbufSs/9hkQAYRAAAXN8Sw39YLAAGEQAA17PU8B8W/SbA6XX5fgAAuIKlZ+zSXwX85/QC/z0fAwALmGfrot/Bs3QADH9ML/Q/8zEAcIF5pv7x+Gw5i94D8JT7AQDgclMAXGVWXy0ABhEAAOe71vAfrhoAgwgAgNNdc/gPVw+AQQQAwPGuPfyHmwTAIAIA4G23GP7DNT4F8KLxhiY+HQAAL5hm5K9jUM5Pr+5mv+iJj1+/fv19PgaAvGnu/zQ9/Pb47DbuEQDDuykCvszHAJA1Df8P08PNZ+K9AuAb9wUAUHbLlf9zdw2AQQQAUHTP4T/c7CbA14w/wGRc+wCA3Ztm3qcx+Oand3P3F/CUbQAAe7aGwX+wqgAYRAAAe7Sm4T+sLgBmD1MHLPq/PQSAe5jm/vj/+K9upq01AL6xDQBgy9Z21v/UqgPgQAgAsCVrHvwHmwiA2fupAz7PxwCwOtPc/9f0sIlZtaUA+MY2AIA12sJZ/1ObC4ADIQDAGmxt8B9sNgAOhAAA97DVwX+w+QA4EAIA3MLWB//BbgLgKTEAwJL2MvSf2mUAPCUGADjXHgf/we4D4EAIAHCMPQ/9pzIB8JwgAGCoDPznsgHwnCAAaKgO/Of8Eb5DFABsm2H/mh9++D9jvpyipGQYPwAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAYAAAD0eNT6AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAxPSURBVHhe7dxddxTHFUBRCGCDk/z/X5rlLNuglKxeCXZAHmm+qurs/TKj1665d043Em/fwBkehuPtxb0djrewLDPCrHx4eLFrLrTnWHaswHywCh8Y/tK9FtpzLDtmYkZYkQ8I3zXjUvsWi457MB+szgeDP1hlqX2LRcctmBF24cPA71Zean9myXENZoTd+BDwfuy1X4/3W7HkuISdvvi/Nsbjw3j57ekniizIsF0X258JAV7DfLA7Bx9UWWxfs+R4CTNCgQOPKS62r1lyPMd8mI+Svx2vbO5xsT06fsxyDfgen43/XoO/P/3E7tRegMX2/8aNzg/jZctffuTFPowR+eV4z8HTgP054M358n+eJddmPp5nPvbmcDdmuZ3GkmsyH6cxH/vyOwB7eme5nc616nHmpzuule+KDTnU/Xwa8+o/93ghXwgdzvrlxiX7PF5+fPqJXXi0s5ePY1B/Pt7zCh537s2X/3nGeDxGgF+Y3IRlt4/Hx/7u/C9ABOzJl/9ljPF4N16+PP3Eyiy6TVhulyUC9mI+Lst87MEhbsByuw5Lbg/m4zrMx/oc4OIst+uy5NZmPq7LfKzNXwEszHID7skOWpsAWNdPxytXZMGty9ndzKfjlcV4fLMoy+22POpci/m4LfOxJk8AFmS53cXH45X5Oasbs5PWpNoWY9Dux13OGszI/ZiRtXgCACfyxTI/ZwSnEwALsdyAmdlRaxEA6/BobQIW3LyczTTsqkU4qEVYbnPxb51zMR9zMR9r8ARgDYYJWImdtQCHtAB3N3NylzMH8zEn8zE/TwAAIEgATM7dzdTc4dyfHTYpu2t+hgdeaey3L8db7mScwefjLfBCAmBiChpYmR02NwEAZ7Dg7se1h/MIAAAIEgCTcncD7MAum5cAgDNZcLfnmsP5BAAABAmACbm7AXZip81JAABAkACAC3CHczuuNVyGAACAIAEwGXc3wI7stvkIAAAIEgAAECQA4EI84rw+1xguRwAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAE/EnTsDO7Li5CAAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAABAkAAAgSAAAQJAAAIAgAQAAQQIAAIIEAAAECQAACBIAE3k7HG8BtmPHzUUAAECQAACAIAEAAEECAACCBAAABAkAAAgSAHAh/sTp+lxjuBwBAABBAgAAggTAZDziBHZkt81HAABAkACAC3B3czuuNVyGAACAIAEwIXc4wE7stDkJAAAIEgBwJnc3t+eaw/kEwKQsOGAHdtm8BAAABAkAOIO7m/tx7eE8AmBiFhywMjtsbgIAXmnsNvNzZ+MM3h1vgReywCanoKf2cLxyP1+OVyZjd81PAABAkABYgMec83F3Mw9nMR87aw0CYA0ecwIrsbMWIAAWoajn4Y5zPs5kHnbVOgTAOhT1BHzRzMvZTMOuWoQAWIgFB8zMjlqLAIATWW7zc0ZwOgGwGAvuPsZl/3S8ZXLO6j7spvU4sEU9DMdbbsByW4v5uC3zsSZPABY15u2fx1uuzHJbjzO7nXGpfzreshhDsjB3Odfni2RtZuT6zMi6PAFYmMED7skOWpvD24C7nOuw3PZgPq7DfKzPAW7Ckrssy20v5uOyzMce/BPAJsY8vj/ecibLbT/O9HLGpfRf/W5CAOzj8xhMf/98Jl8U+3K25xuX8Mfx4r/63YQA2Mu/x4D6k5xX8gWxP2f8euPSfRwvvzz9xA4Mw57ePTw8/Ha85wS+GFr8TsDLjPF4fOzvzn8zlt7GLLnT+PJvMh+nMR/7crCbs+SeZ7m1mY/nmY+9+R2AzRngbxuX5QfXhsfPwPDD8SNfebwwx1s25YAj3On8j8XGt5iRJ2M8/jFe/vX0EzuzCGPqS86XP88xH+ajxGEHFZecxcZLmBEKHHhYZclZbLyG+WB3Dp73Y8/9erzfisXGJewaAmM8PowX/19ImAXJ73Zacr74uQYzwm58CPiDlZecpcYtmBF24cPAd62y6Cw17sF8sDofDP7SjIvOUmMmZoQV+YDwYvdadhYaKzAfrMIHhrNcc9lZaOzAjDCnN2/+A2VsEbyad6SxAAAAAElFTkSuQmCC\"","import React from \"react\";\r\nimport \"./PianoTiles.css\";\r\n\r\nfunction initPianoTile(\r\n  pianoTiles: JSX.Element[],\r\n  note: string,\r\n  octave: number,\r\n  tileColor: string,\r\n  id: number\r\n) {\r\n  pianoTiles.unshift(\r\n    <div\r\n      className={tileColor === \"w\" ? \"pianoTileWhite\" : \"pianoTileBlack\"}\r\n      id={\"piano\" + id.toString()}\r\n      title={note + octave.toString()}\r\n      key={\"piano\" + id.toString()}\r\n      ref={null}\r\n      // onClick={() => {\r\n      //   console.log(\"ID: \" + id + \"; NOTE: \" + note + octave.toString());\r\n      // }}\r\n    >\r\n      {note + octave.toString()}\r\n    </div>\r\n  );\r\n}\r\n\r\nconst numberOfGridRows = 120;\r\nlet pianoTiles: JSX.Element[] = [];\r\n\r\nfor (let i = 0; i < numberOfGridRows; i++) {\r\n  switch (i % 12) {\r\n    case 0:\r\n      initPianoTile(pianoTiles, \"C\", (i / 12) >> 0, \"w\", i);\r\n      break;\r\n    case 1:\r\n      initPianoTile(pianoTiles, \"C#\", (i / 12) >> 0, \"b\", i);\r\n      break;\r\n    case 2:\r\n      initPianoTile(pianoTiles, \"D\", (i / 12) >> 0, \"w\", i);\r\n      break;\r\n    case 3:\r\n      initPianoTile(pianoTiles, \"D#\", (i / 12) >> 0, \"b\", i);\r\n      break;\r\n    case 4:\r\n      initPianoTile(pianoTiles, \"E\", (i / 12) >> 0, \"w\", i);\r\n      break;\r\n    case 5:\r\n      initPianoTile(pianoTiles, \"F\", (i / 12) >> 0, \"w\", i);\r\n      break;\r\n    case 6:\r\n      initPianoTile(pianoTiles, \"F#\", (i / 12) >> 0, \"b\", i);\r\n      break;\r\n    case 7:\r\n      initPianoTile(pianoTiles, \"G\", (i / 12) >> 0, \"w\", i);\r\n      break;\r\n    case 8:\r\n      initPianoTile(pianoTiles, \"G#\", (i / 12) >> 0, \"b\", i);\r\n      break;\r\n    case 9:\r\n      initPianoTile(pianoTiles, \"A\", (i / 12) >> 0, \"w\", i);\r\n      break;\r\n    case 10:\r\n      initPianoTile(pianoTiles, \"A#\", (i / 12) >> 0, \"b\", i);\r\n      break;\r\n    case 11:\r\n      initPianoTile(pianoTiles, \"B\", (i / 12) >> 0, \"w\", i);\r\n      break;\r\n  }\r\n}\r\n\r\nconst PianoTiles = React.memo(() => {\r\n  return (\r\n    <div className=\"pianoTiles\" key=\"pianoTiles\">\r\n      {pianoTiles}\r\n    </div>\r\n  );\r\n});\r\n\r\nexport default PianoTiles;\r\n","import Konva from \"konva\";\r\nimport { useRef, useEffect } from \"react\";\r\nimport { Rect, Transformer } from \"react-konva\";\r\nimport { getPositionX, getPositionY } from \"../../GetPositionFunctions\";\r\nimport { ShapeProps, CanvasProps } from \"../../Interfaces\";\r\n\r\ninterface Props {\r\n  dataKey: number;\r\n  shapeProps: ShapeProps;\r\n  canvasProps: CanvasProps;\r\n  isSelected: boolean;\r\n  handleSelect: () => void;\r\n  changeSize: (newSize: number) => void;\r\n  changePos: (newPosX: number, newPosY: number) => void;\r\n  getNoteInfo?: (posX: number, posY: number, length: number) => void;\r\n}\r\n\r\nfunction Note(props: Props) {\r\n  const canvasWidth = props.canvasProps.canvasWidth;\r\n  const canvasHeight = props.canvasProps.canvasHeight;\r\n  const blockSnapSize = props.canvasProps.blockSnapSize;\r\n  const tileHeight = props.canvasProps.trackOrTileHeight;\r\n\r\n  const noteRef = useRef<Konva.Rect>(null);\r\n  const trRefNote = useRef<Konva.Transformer>(null);\r\n\r\n  useEffect(() => {\r\n    if (props.isSelected) {\r\n      trRefNote.current!.nodes([noteRef.current!]);\r\n      trRefNote.current!.getLayer()!.batchDraw();\r\n    }\r\n  }, [props.isSelected]);\r\n\r\n  return (\r\n    <>\r\n      <Rect\r\n        dataKey={props.dataKey}\r\n        x={props.shapeProps.posX}\r\n        y={props.shapeProps.posY}\r\n        width={props.shapeProps.width * blockSnapSize}\r\n        height={tileHeight}\r\n        fill={props.shapeProps.color}\r\n        strokeWidth={0}\r\n        stroke=\"black\"\r\n        draggable={true}\r\n        ref={noteRef}\r\n        onDragStart={(e) => {\r\n          if (e.evt.button === 0) {\r\n            props.handleSelect();\r\n          }\r\n        }}\r\n        onClick={(e) => {\r\n          if (e.evt.button === 0) {\r\n            props.handleSelect();\r\n          }\r\n        }}\r\n        // onTap={() => props.handleSelect()}\r\n        onMouseOver={(e) => {\r\n          e.target.setAttrs({ fill: \"yellow\" });\r\n          e.currentTarget.draw();\r\n        }}\r\n        onMouseLeave={(e) => {\r\n          e.target.setAttrs({ fill: props.shapeProps.color });\r\n          e.currentTarget.draw();\r\n        }}\r\n        onDragEnd={(e) => {\r\n          const posX = getPositionX(\r\n            e.target.x(),\r\n            e.target.width(),\r\n            canvasWidth,\r\n            blockSnapSize,\r\n            false\r\n          );\r\n          const posY = getPositionY(\r\n            e.target.y(),\r\n            canvasHeight,\r\n            tileHeight,\r\n            false\r\n          );\r\n\r\n          e.target.position({\r\n            x: props.shapeProps.posX,\r\n            y: props.shapeProps.posY,\r\n          });\r\n          props.changePos(posX, posY);\r\n        }}\r\n        onTransformEnd={(e) => {\r\n          const scaleAmmount = noteRef.current!.scaleX();\r\n          noteRef.current!.scaleX(1);\r\n          const newSize = Math.round(props.shapeProps.width * scaleAmmount);\r\n\r\n          if (newSize * blockSnapSize > canvasWidth - e.target.x()) {\r\n            props.changeSize(\r\n              Math.round((canvasWidth - e.target.x()) / blockSnapSize)\r\n            );\r\n          } else {\r\n            props.changeSize(newSize);\r\n          }\r\n\r\n          // if (newSize < 1) {\r\n          //   props.changeSize(1);\r\n          // } else {\r\n          //   props.changeSize(newSize);\r\n          // }\r\n        }}\r\n      />\r\n      {props.isSelected && (\r\n        <Transformer\r\n          key=\"trNote\"\r\n          ref={trRefNote}\r\n          enabledAnchors={[\"middle-right\"]}\r\n          rotateEnabled={false}\r\n          borderStroke=\"orange\"\r\n          anchorCornerRadius={5}\r\n          anchorFill=\"orange\"\r\n          anchorStrokeWidth={0}\r\n          resizeEnabled={true}\r\n          boundBoxFunc={(oldBox, newBox) => {\r\n            if (newBox.width < blockSnapSize) {\r\n              trRefNote.current!.stopTransform();\r\n              return oldBox;\r\n            }\r\n            return newBox;\r\n          }}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Note;\r\n","import { KonvaEventObject } from \"konva/types/Node\";\r\nimport { useState } from \"react\";\r\nimport { Layer, Stage, Rect, Line } from \"react-konva\";\r\nimport Note from \"./Note\";\r\nimport { getPositionX, getPositionY } from \"../../GetPositionFunctions\";\r\nimport \"./PianoRollCanvas.css\";\r\nimport { MidiClip, MidiNote, NoteRectProps, Rootstate } from \"../../Interfaces\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { addNewNote, deleteNote, updateNote } from \"../../Actions\";\r\n\r\nfunction checkDeselect(\r\n  e: KonvaEventObject<MouseEvent | TouchEvent>,\r\n  selectNoteId: React.Dispatch<React.SetStateAction<number>>\r\n) {\r\n  // deselect when clicked on empty area\r\n  if (\r\n    e.target === e.target.getStage() ||\r\n    e.target.getAttr(\"name\") === \"darkMeasure\" ||\r\n    e.target.getAttr(\"name\") === \"line\"\r\n  ) {\r\n    selectNoteId(-1);\r\n  }\r\n}\r\n\r\nfunction getNoteName(tileID: number) {\r\n  switch (tileID % 12) {\r\n    case 0:\r\n      return \"C\" + Math.trunc(tileID / 12);\r\n    case 1:\r\n      return \"C#\" + Math.trunc(tileID / 12);\r\n    case 2:\r\n      return \"D\" + Math.trunc(tileID / 12);\r\n    case 3:\r\n      return \"D#\" + Math.trunc(tileID / 12);\r\n    case 4:\r\n      return \"E\" + Math.trunc(tileID / 12);\r\n    case 5:\r\n      return \"F\" + Math.trunc(tileID / 12);\r\n    case 6:\r\n      return \"F#\" + Math.trunc(tileID / 12);\r\n    case 7:\r\n      return \"G\" + Math.trunc(tileID / 12);\r\n    case 8:\r\n      return \"G#\" + Math.trunc(tileID / 12);\r\n    case 9:\r\n      return \"A\" + Math.trunc(tileID / 12);\r\n    case 10:\r\n      return \"A#\" + Math.trunc(tileID / 12);\r\n    case 11:\r\n      return \"B\" + Math.trunc(tileID / 12);\r\n\r\n    default:\r\n      return \"Unknown\";\r\n  }\r\n}\r\n\r\nfunction getNoteStartTime(offset: number, blockSnapSizeToTick: number) {\r\n  return offset * blockSnapSizeToTick;\r\n}\r\n\r\nfunction getNoteDuration(length: number, blockSnapSizeToTick: number) {\r\n  return length * blockSnapSizeToTick;\r\n}\r\n\r\nfunction getNoteInfo(\r\n  posX: number,\r\n  posY: number,\r\n  length: number,\r\n  tileHeight: number,\r\n  blockSnapSize: number,\r\n  blockSnapSizeToTick: number\r\n) {\r\n  // console.log(posX, posY, length);\r\n\r\n  return {\r\n    noteName: getNoteName(119 - posY / tileHeight),\r\n    startTime: getNoteStartTime(posX / blockSnapSize, blockSnapSizeToTick),\r\n    noteDuration: getNoteDuration(length, blockSnapSizeToTick),\r\n  };\r\n}\r\n\r\nfunction getNotePosY(noteName: string, tileHeight: number) {\r\n  let octave: number;\r\n  let note: string;\r\n\r\n  if (noteName.length === 3) {\r\n    octave = +noteName[2];\r\n    note = noteName[0] + noteName[1];\r\n  } else {\r\n    octave = +noteName[1];\r\n    note = noteName[0];\r\n  }\r\n\r\n  const octaveOffset = (9 - octave) * (tileHeight * 12);\r\n\r\n  switch (note) {\r\n    case \"B\":\r\n      return octaveOffset;\r\n    case \"A#\":\r\n      return octaveOffset + tileHeight;\r\n    case \"A\":\r\n      return octaveOffset + tileHeight * 2;\r\n    case \"G#\":\r\n      return octaveOffset + tileHeight * 3;\r\n    case \"G\":\r\n      return octaveOffset + tileHeight * 4;\r\n    case \"F#\":\r\n      return octaveOffset + tileHeight * 5;\r\n    case \"F\":\r\n      return octaveOffset + tileHeight * 6;\r\n    case \"E\":\r\n      return octaveOffset + tileHeight * 7;\r\n    case \"D#\":\r\n      return octaveOffset + tileHeight * 8;\r\n    case \"D\":\r\n      return octaveOffset + tileHeight * 9;\r\n    case \"C#\":\r\n      return octaveOffset + tileHeight * 10;\r\n    case \"C\":\r\n      return octaveOffset + tileHeight * 11;\r\n\r\n    default:\r\n      return -1;\r\n  }\r\n}\r\n\r\nfunction getNotePosX(startTime: number, blockSnapSizeToTick: number) {\r\n  return startTime / blockSnapSizeToTick;\r\n}\r\n\r\nfunction getNoteWidth(length: number, blockSnapSizeToTick: number) {\r\n  return length / blockSnapSizeToTick;\r\n}\r\n\r\nfunction initNotes(\r\n  notes: MidiNote[],\r\n  tileHeight: number,\r\n  blockSnapSize: number,\r\n  blockSnapSizeToTick: number\r\n) {\r\n  if (notes.length === 0) {\r\n    return [];\r\n  }\r\n\r\n  // Add existing notes from the MIDI clip to curNotesRect state\r\n  let initedNotes: NoteRectProps[] = [];\r\n\r\n  notes.forEach((note) => {\r\n    initedNotes.push({\r\n      dataKey: note.dataKey,\r\n      posX: getNotePosX(note.startTime, blockSnapSizeToTick) * blockSnapSize,\r\n      posY: getNotePosY(note.note, tileHeight),\r\n      width: getNoteWidth(note.length, blockSnapSizeToTick),\r\n    });\r\n  });\r\n\r\n  // console.log(\"INITED NOTES\", initedNotes);\r\n\r\n  return initedNotes;\r\n}\r\n\r\nfunction initDataKey(notes: MidiNote[]) {\r\n  if (notes.length === 0) {\r\n    return 0;\r\n  } else {\r\n    return (\r\n      Math.max.apply(\r\n        Math,\r\n        notes.map((note) => {\r\n          return note.dataKey;\r\n        })\r\n      ) + 1\r\n    );\r\n  }\r\n}\r\n\r\ninterface Props {\r\n  midiClip: MidiClip;\r\n  gridPadding: number;\r\n}\r\n\r\nconst tileHeight = 27; // 25 + 2 -> tile + margins\r\nconst canvasHeight = tileHeight * 120; //piano tile * number of grid rows\r\n\r\nfunction PianoRollCanvas(props: Props) {\r\n  // TODO: these values have to be responsive, if window resize event fires up, also less hardcoded\r\n  // console.log(\"new MIDI IN CANV\", props.midiClip);\r\n\r\n  const numOfBeats = props.midiClip.length; // How many measures long the piano roll should be\r\n  const gridPadding = props.gridPadding / 4; // density of the grids in a beat\r\n  const midiNoteColor = useSelector(\r\n    (state: Rootstate) => state.pianoRollCanvasProps.midiNoteColor\r\n  );\r\n\r\n  const blockSnapSizeToTick = 192 / gridPadding;\r\n  const dispatch = useDispatch();\r\n\r\n  const canvasWidth =\r\n    numOfBeats <= 8\r\n      ? window.innerWidth -\r\n        61 +\r\n        (numOfBeats * gridPadding -\r\n          ((window.innerWidth - 61) % (numOfBeats * gridPadding)))\r\n      : ((window.innerWidth -\r\n          61 +\r\n          (8 * gridPadding - ((window.innerWidth - 61) % (8 * gridPadding)))) /\r\n          8) *\r\n        numOfBeats;\r\n  // TODO: if numOfBeats > 4 then we should use a vertical scrollbar to navigate\r\n\r\n  // TODO: blockSnapSize should be changeable, and the canvas should draw invisible lines to snap to\r\n  //console.log(canvasWidth / (numOfBeats * gridPadding));\r\n  const blockSnapSize = Math.round(canvasWidth / (numOfBeats * gridPadding));\r\n\r\n  const curNotesRect = initNotes(\r\n    props.midiClip.notes,\r\n    tileHeight,\r\n    blockSnapSize,\r\n    blockSnapSizeToTick\r\n  );\r\n\r\n  // console.log(\"PIANO CANVAS RENDER\", curNotesRect);\r\n\r\n  const [keyGenerator, setKeyGenerator] = useState<number>(\r\n    initDataKey(props.midiClip.notes)\r\n  );\r\n  const [selectedNoteId, selectNoteId] = useState<number>(-1);\r\n\r\n  let gridLayerComponents: JSX.Element[] = [];\r\n\r\n  for (let i = 0; i <= numOfBeats * gridPadding; i += 1) {\r\n    gridLayerComponents.push(\r\n      <Line\r\n        key={\"v_\" + i}\r\n        name=\"line\"\r\n        points={[\r\n          i * blockSnapSize + 0.5,\r\n          0,\r\n          i * blockSnapSize + 0.5,\r\n          canvasHeight,\r\n        ]}\r\n        stroke={i % (gridPadding / 4) ? \"gray\" : \"black\"}\r\n        strokeWidth={i % (gridPadding / 4) ? 1 : 1.5}\r\n      />\r\n    );\r\n  }\r\n\r\n  for (let i = 0; i < canvasHeight; i += tileHeight) {\r\n    gridLayerComponents.push(\r\n      <Line\r\n        key={\"h_\" + i}\r\n        name=\"line\"\r\n        points={[0, i, canvasWidth, i]}\r\n        stroke=\"gray\"\r\n        strokeWidth={1}\r\n      />\r\n    );\r\n  }\r\n\r\n  let darkMeasureRects: JSX.Element[] = [];\r\n\r\n  for (let i = 1; i <= numOfBeats / 2; i++) {\r\n    darkMeasureRects.push(\r\n      <Rect\r\n        key={\"d_\" + i * 2}\r\n        name=\"darkMeasure\"\r\n        x={i * 2 * (canvasWidth / numOfBeats) - canvasWidth / numOfBeats}\r\n        y={0}\r\n        height={canvasHeight}\r\n        width={canvasWidth / numOfBeats}\r\n        fill=\"#aaa\"\r\n        opacity={0.5}\r\n      />\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div id=\"PianoRollCanvas\" key=\"PianoRollCanvas\">\r\n      <Stage\r\n        key=\"pianoRollBody\"\r\n        className=\"stageClass\"\r\n        width={canvasWidth + 2} // + 2 is needed if a note's transform anchor is at the edge, so the user can reach it\r\n        height={canvasHeight}\r\n        onMouseDown={(e) => {\r\n          if (selectedNoteId !== -1) {\r\n            checkDeselect(e, selectNoteId);\r\n          }\r\n        }}\r\n        onDblClick={(e) => {\r\n          if (e.target.getAttr(\"dataKey\") === undefined) {\r\n            const transform = e.currentTarget\r\n              .getAbsoluteTransform()\r\n              .copy()\r\n              .invert();\r\n            const pos = e.currentTarget.getStage()!.getPointerPosition()!;\r\n\r\n            const posX = getPositionX(\r\n              transform.point(pos).x,\r\n              4 * blockSnapSize, // TODO: ez biztos nincs hardcodeolva?\r\n              canvasWidth,\r\n              blockSnapSize,\r\n              true\r\n            );\r\n\r\n            const posY = getPositionY(\r\n              transform.point(pos).y,\r\n              canvasHeight,\r\n              tileHeight,\r\n              true\r\n            );\r\n\r\n            // setCurNotesRect([\r\n            //   ...curNotesRect,\r\n            //   {\r\n            //     dataKey: keyGenerator,\r\n            //     posX: posX,\r\n            //     posY: posY,\r\n            //     width: 4,\r\n            //   },\r\n            // ]);\r\n\r\n            const newNoteInfo = getNoteInfo(\r\n              posX,\r\n              posY,\r\n              4,\r\n              tileHeight,\r\n              blockSnapSize,\r\n              blockSnapSizeToTick\r\n            );\r\n            dispatch(\r\n              addNewNote({\r\n                midiClipDataKey: props.midiClip.dataKey,\r\n                noteDataKey: keyGenerator,\r\n                trackDataKey: props.midiClip.trackKey,\r\n                type: \"ADD\",\r\n                newNoteProps: {\r\n                  dataKey: keyGenerator,\r\n                  length: newNoteInfo.noteDuration,\r\n                  note: newNoteInfo.noteName,\r\n                  startTime: newNoteInfo.startTime,\r\n                },\r\n              })\r\n            );\r\n            setKeyGenerator(keyGenerator + 1);\r\n          }\r\n        }}\r\n        onContextMenu={(e) => {\r\n          e.evt.preventDefault();\r\n        }}\r\n      >\r\n        <Layer key=\"measureLayer\">{darkMeasureRects}</Layer>\r\n        <Layer key=\"gridLayer\">{gridLayerComponents}</Layer>\r\n        <Layer\r\n          key=\"notesLayer\"\r\n          onClick={(e) => {\r\n            if (e.evt.button === 2) {\r\n              const curDataKey = e.target.getAttr(\"dataKey\");\r\n\r\n              dispatch(\r\n                deleteNote({\r\n                  midiClipDataKey: props.midiClip.dataKey,\r\n                  noteDataKey: curDataKey,\r\n                  trackDataKey: props.midiClip.trackKey,\r\n                  type: \"DELETE\",\r\n                })\r\n              );\r\n\r\n              // setCurNotesRect(\r\n              //   curNotesRect.filter((item) => item.dataKey !== curDataKey)\r\n              // );\r\n            }\r\n          }}\r\n        >\r\n          {curNotesRect.map((item, i) => {\r\n            return (\r\n              <Note\r\n                key={item.dataKey}\r\n                dataKey={item.dataKey}\r\n                shapeProps={{\r\n                  width: item.width,\r\n                  posX: item.posX,\r\n                  posY: item.posY,\r\n                  color: midiNoteColor,\r\n                }}\r\n                canvasProps={{\r\n                  canvasWidth: canvasWidth,\r\n                  canvasHeight: canvasHeight,\r\n                  blockSnapSize: blockSnapSize,\r\n                  trackOrTileHeight: tileHeight,\r\n                  gridPadding: gridPadding,\r\n                }}\r\n                isSelected={item.dataKey === selectedNoteId}\r\n                handleSelect={() => {\r\n                  if (selectedNoteId !== item.dataKey) {\r\n                    selectNoteId(item.dataKey);\r\n                  }\r\n                }}\r\n                changeSize={(newSize) => {\r\n                  if (newSize === curNotesRect[i].width) {\r\n                    return;\r\n                  }\r\n\r\n                  // const newCurNotesRect = curNotesRect.slice();\r\n                  // newCurNotesRect[i].width = newSize;\r\n                  const noteToUpdateInfo = getNoteInfo(\r\n                    curNotesRect[i].posX,\r\n                    curNotesRect[i].posY,\r\n                    newSize,\r\n                    tileHeight,\r\n                    blockSnapSize,\r\n                    blockSnapSizeToTick\r\n                  );\r\n\r\n                  dispatch(\r\n                    updateNote({\r\n                      midiClipDataKey: props.midiClip.dataKey,\r\n                      noteDataKey: curNotesRect[i].dataKey,\r\n                      trackDataKey: props.midiClip.trackKey,\r\n                      type: \"UPDATE\",\r\n                      newNoteProps: {\r\n                        dataKey: curNotesRect[i].dataKey,\r\n                        length: noteToUpdateInfo.noteDuration,\r\n                        note: noteToUpdateInfo.noteName,\r\n                        startTime: noteToUpdateInfo.startTime,\r\n                      },\r\n                    })\r\n                  );\r\n\r\n                  // setCurNotesRect(newCurNotesRect);\r\n                }}\r\n                changePos={(newPosX: number, newPosY: number) => {\r\n                  if (\r\n                    newPosX === curNotesRect[i].posX &&\r\n                    newPosY === curNotesRect[i].posY\r\n                  ) {\r\n                    return;\r\n                  }\r\n\r\n                  // const newCurNotesRect = curNotesRect.slice();\r\n                  // newCurNotesRect[i].posX = newPosX;\r\n                  // newCurNotesRect[i].posY = newPosY;\r\n\r\n                  const noteToUpdateInfo = getNoteInfo(\r\n                    newPosX,\r\n                    newPosY,\r\n                    curNotesRect[i].width,\r\n                    tileHeight,\r\n                    blockSnapSize,\r\n                    blockSnapSizeToTick\r\n                  );\r\n\r\n                  dispatch(\r\n                    updateNote({\r\n                      midiClipDataKey: props.midiClip.dataKey,\r\n                      noteDataKey: curNotesRect[i].dataKey,\r\n                      trackDataKey: props.midiClip.trackKey,\r\n                      type: \"UPDATE\",\r\n                      newNoteProps: {\r\n                        dataKey: curNotesRect[i].dataKey,\r\n                        length: noteToUpdateInfo.noteDuration,\r\n                        note: noteToUpdateInfo.noteName,\r\n                        startTime: noteToUpdateInfo.startTime,\r\n                      },\r\n                    })\r\n                  );\r\n\r\n                  // setCurNotesRect(newCurNotesRect);\r\n                }}\r\n              />\r\n            );\r\n          })}\r\n        </Layer>\r\n      </Stage>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default PianoRollCanvas;\r\n","import PianoTiles from \"./PianoRollViewComponents/PianoTiles\";\r\nimport \"./PianoRollView.css\";\r\nimport PianoRollCanvas from \"./PianoRollViewComponents/PianoRollCanvas\";\r\nimport { Rootstate } from \"../Interfaces\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { deselectMidiClip } from \"../Actions\";\r\n\r\nfunction PianoRollView() {\r\n  const dispatch = useDispatch();\r\n\r\n  const [curPianoRollGridPadding, setCurPianoRollGridPadding] =\r\n    useState<number>(16);\r\n\r\n  const selectedMidiClipInfo = useSelector(\r\n    (state: Rootstate) => state.selectedMidiClip\r\n  );\r\n\r\n  const curTrackInfos = useSelector((state: Rootstate) => state.curTracks);\r\n\r\n  // console.log(\"new MIDI CLIP\", selectedMidiClipInfo, curTrackInfos);\r\n\r\n  let selectedMidiClip;\r\n  if (selectedMidiClipInfo !== null) {\r\n    selectedMidiClip = curTrackInfos.tracks[\r\n      selectedMidiClipInfo.trackKey\r\n    ].midiClips.find(\r\n      (midiClip) => midiClip.dataKey === selectedMidiClipInfo.midiClipDataKey\r\n    );\r\n  }\r\n\r\n  useEffect(() => {\r\n    document.getElementById(\"piano60\")?.scrollIntoView({ behavior: \"smooth\" });\r\n  }, [selectedMidiClipInfo]);\r\n\r\n  // Currently selected MidiClip changed track, so hide pianoRoll\r\n  if (selectedMidiClip === undefined) {\r\n    dispatch(deselectMidiClip());\r\n    return <></>;\r\n  } else {\r\n    return (\r\n      <>\r\n        {selectedMidiClipInfo !== null && selectedMidiClip !== undefined && (\r\n          <div className=\"pianoRollView\">\r\n            <span>Rácsok sűrűsége:</span>\r\n            <select\r\n              defaultValue=\"16\"\r\n              onChange={(e) => setCurPianoRollGridPadding(+e.target.value)}\r\n            >\r\n              <option value=\"4\">4</option>\r\n              <option value=\"8\">8</option>\r\n              <option value=\"16\">16</option>\r\n              <option value=\"32\">32</option>\r\n              <option value=\"64\">64</option>\r\n            </select>\r\n            <div key=\"gridContainer\" className=\"gridContainer\">\r\n              <PianoTiles />\r\n              <PianoRollCanvas\r\n                midiClip={selectedMidiClip}\r\n                gridPadding={curPianoRollGridPadding}\r\n              />\r\n            </div>\r\n          </div>\r\n        )}\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default PianoRollView;\r\n","// import { connectAdvanced, useDispatch } from \"react-redux\";\r\nimport \"./App.css\";\r\nimport ArrangementView from \"./AppComponents/ArrangementView/ArrangementView\";\r\n// import { appAuth } from \"./AppComponents/firebase\";\r\nimport Footer from \"./AppComponents/Footer/Footer\";\r\nimport Header from \"./AppComponents/Header/Header\";\r\nimport NavigationBar from \"./AppComponents/NavigationBar/NavigationBar\";\r\nimport PianoRollView from \"./AppComponents/PianoRollView/PianoRollView\";\r\n// import * as Tone from \"tone\";\r\n\r\nfunction App() {\r\n  // const dispatch = useDispatch();\r\n\r\n  return (\r\n    <div className=\"App\" id=\"App\">\r\n      <Header />\r\n      <NavigationBar />\r\n      <div className=\"mainPart\">\r\n        <ArrangementView />\r\n        <PianoRollView />\r\n      </div>\r\n      <Footer />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import {\r\n  MidiClip,\r\n  MidiNote,\r\n  ModifyMidiClip,\r\n  ModifyNote,\r\n  TrackInterface,\r\n  TrackProps,\r\n} from \"../Interfaces\";\r\n\r\nfunction midiClipOrNoteCollideScenarioOne(\r\n  newMidiClipOrNoteStartTime: number,\r\n  otherMidiClipOrNoteStartTime: number,\r\n  otherMidiClipOrNoteEndTime: number\r\n) {\r\n  return (\r\n    newMidiClipOrNoteStartTime >= otherMidiClipOrNoteStartTime &&\r\n    newMidiClipOrNoteStartTime < otherMidiClipOrNoteEndTime\r\n  );\r\n}\r\n\r\nfunction midiClipOrNoteCollideScenarioTwo(\r\n  newMidiClipOrNoteEndTime: number,\r\n  otherMidiClipOrNoteStartTime: number,\r\n  otherMidiClipOrNoteEndTime: number\r\n) {\r\n  return (\r\n    newMidiClipOrNoteEndTime > otherMidiClipOrNoteStartTime &&\r\n    newMidiClipOrNoteEndTime <= otherMidiClipOrNoteEndTime\r\n  );\r\n}\r\n\r\nfunction midiClipOrNoteCollideScenarioThree(\r\n  newMidiClipOrNoteStartTime: number,\r\n  newMidiClipOrNoteEndTime: number,\r\n  otherMidiClipOrNoteStartTime: number,\r\n  otherMidiClipOrNoteEndTime: number\r\n) {\r\n  return (\r\n    newMidiClipOrNoteStartTime <= otherMidiClipOrNoteStartTime &&\r\n    newMidiClipOrNoteEndTime >= otherMidiClipOrNoteEndTime\r\n  );\r\n}\r\n\r\nfunction isMidiClipColliding(\r\n  newMidiClip: MidiClip,\r\n  otherMidiClips: MidiClip[]\r\n) {\r\n  // 3 midiClipCollide scenarios:\r\n  //    1. newMidiClip's startTime is between (inclusive) the starTime and startTime + length of an other one\r\n  //    2. newMidiClip's startTime + length is between the starTime and startTime + length of an other one\r\n  //    3. newMidiClip's startTime is equal or less AND startTime + length is greater or equal compared to an other one\r\n  const newMidiClipStartTime = newMidiClip.startTime;\r\n  const newMidiClipEndTime = newMidiClipStartTime + newMidiClip.length * 192;\r\n\r\n  return otherMidiClips.some((otherMidiClip) => {\r\n    // This is important when changing size of MIDI clip\r\n    if (newMidiClip.dataKey === otherMidiClip.dataKey) {\r\n      return false;\r\n    }\r\n\r\n    const otherMidiClipStartTime = otherMidiClip.startTime;\r\n    const otherMidiClipEndTime =\r\n      otherMidiClipStartTime + otherMidiClip.length * 192;\r\n\r\n    return (\r\n      midiClipOrNoteCollideScenarioOne(\r\n        newMidiClipStartTime,\r\n        otherMidiClipStartTime,\r\n        otherMidiClipEndTime\r\n      ) ||\r\n      midiClipOrNoteCollideScenarioTwo(\r\n        newMidiClipEndTime,\r\n        otherMidiClipStartTime,\r\n        otherMidiClipEndTime\r\n      ) ||\r\n      midiClipOrNoteCollideScenarioThree(\r\n        newMidiClipStartTime,\r\n        newMidiClipEndTime,\r\n        otherMidiClipStartTime,\r\n        otherMidiClipEndTime\r\n      )\r\n    );\r\n  });\r\n}\r\n\r\nfunction isMidiNoteColliding(\r\n  newMidiNote: MidiNote,\r\n  otherMidiNotes: MidiNote[]\r\n) {\r\n  // 3 midiNoteCollide scenarios IF notes are the same:\r\n  //    same as midiClip, just with midiNotes\r\n\r\n  const newMidiNoteStartTime = newMidiNote.startTime;\r\n  const newMidiNoteEndTime = newMidiNoteStartTime + newMidiNote.length;\r\n\r\n  return otherMidiNotes.some((otherMidiNote) => {\r\n    // This is important when changing size of MIDI clip\r\n    if (newMidiNote.dataKey === otherMidiNote.dataKey) {\r\n      return false;\r\n    }\r\n\r\n    // If we have 2 different notes, they cannot collide\r\n    if (newMidiNote.note !== otherMidiNote.note) {\r\n      return false;\r\n    }\r\n\r\n    const otherMidiNoteStartTime = otherMidiNote.startTime;\r\n    const otherMidiNoteEndTime = otherMidiNoteStartTime + otherMidiNote.length;\r\n\r\n    return (\r\n      midiClipOrNoteCollideScenarioOne(\r\n        newMidiNoteStartTime,\r\n        otherMidiNoteStartTime,\r\n        otherMidiNoteEndTime\r\n      ) ||\r\n      midiClipOrNoteCollideScenarioTwo(\r\n        newMidiNoteEndTime,\r\n        otherMidiNoteStartTime,\r\n        otherMidiNoteEndTime\r\n      ) ||\r\n      midiClipOrNoteCollideScenarioThree(\r\n        newMidiNoteStartTime,\r\n        newMidiNoteEndTime,\r\n        otherMidiNoteStartTime,\r\n        otherMidiNoteEndTime\r\n      )\r\n    );\r\n  });\r\n}\r\n\r\nfunction isAllowed(newMidiNote: MidiNote, otherMidiNotes: MidiNote[]) {\r\n  return otherMidiNotes.some(\r\n    (otherMidiNote) =>\r\n      newMidiNote.dataKey !== otherMidiNote.dataKey &&\r\n      newMidiNote.startTime === otherMidiNote.startTime\r\n  );\r\n}\r\n\r\nconst CurTracksReducer = (\r\n  state: {\r\n    tracks: TrackInterface[];\r\n    modifiedNote: ModifyNote | null;\r\n    modifiedMidiClip: ModifyMidiClip | null;\r\n    isImported: boolean;\r\n  } = {\r\n    tracks: [\r\n      {\r\n        dataKey: 0,\r\n        instrument: \"PolySynth\",\r\n        midiClips: [],\r\n        name: \"Sáv_A\",\r\n        isMuted: false,\r\n      },\r\n      {\r\n        dataKey: 1,\r\n        instrument: \"PolySynth\",\r\n        midiClips: [],\r\n        name: \"Sáv_B\",\r\n        isMuted: false,\r\n      },\r\n    ],\r\n    modifiedNote: null,\r\n    modifiedMidiClip: null,\r\n    isImported: false,\r\n  },\r\n  action: {\r\n    type: string;\r\n    trackIndex: number;\r\n    // payload?: string | JSON;\r\n    importedJSON?: TrackInterface[];\r\n    newTrackProps?: TrackProps;\r\n    modifyTrack?: TrackInterface;\r\n    modifyNote?: ModifyNote;\r\n    modifyMidiClip?: ModifyMidiClip;\r\n  }\r\n) => {\r\n  switch (action.type) {\r\n    case \"EXPORT_PROJECT\":\r\n      const element = document.createElement(\"a\");\r\n      const file = new Blob(\r\n        [\r\n          \"!!!WARNING!!!\\nDO NOT MODIFY THIS FILE OR THE PROJECT MIGHT NOT LOAD CORRECTLY!\\n\" +\r\n            JSON.stringify(state.tracks) +\r\n            \"\\n\" +\r\n            (document.getElementById(\"BPMInput\")! as HTMLInputElement).value,\r\n        ],\r\n        { type: \"text/plain\" }\r\n      );\r\n      element.href = URL.createObjectURL(file);\r\n      element.download = \"SuddenMusicProject.sudden\";\r\n      element.click();\r\n\r\n      return state;\r\n\r\n    case \"IMPORT_PROJECT\":\r\n      if (action.importedJSON === undefined) {\r\n        throw Error(\"importedJSON is missing when importing\");\r\n      }\r\n\r\n      return {\r\n        tracks: action.importedJSON,\r\n        modifiedNote: null,\r\n        modifiedMidiClip: null,\r\n        isImported: true,\r\n      };\r\n\r\n    case \"CLEAR_IMPORT_FLAG\":\r\n      return {\r\n        ...state,\r\n        isImported: false,\r\n      };\r\n\r\n    case \"ADD_NEW_TRACK\":\r\n      if (action.modifyTrack === undefined) {\r\n        throw Error(\"Track missing!\");\r\n      }\r\n\r\n      if (!state.tracks.length) {\r\n        return {\r\n          tracks: [\r\n            {\r\n              dataKey: 0,\r\n              name: action.modifyTrack.name,\r\n              // color: action.modifyTrack.color,\r\n              instrument: action.modifyTrack!.instrument,\r\n              midiClips: [],\r\n            },\r\n          ],\r\n          modifiedNote: null,\r\n          modifiedMidiClip: null,\r\n          isImported: false,\r\n        };\r\n      }\r\n\r\n      const maxDataKey = state.tracks[state.tracks.length - 1].dataKey;\r\n\r\n      return {\r\n        tracks: [\r\n          ...state.tracks,\r\n          {\r\n            dataKey: maxDataKey + 1,\r\n            name: action.modifyTrack.name,\r\n            // color: action.modifyTrack.color,\r\n            instrument: action.modifyTrack!.instrument,\r\n            midiClips: [],\r\n          },\r\n        ],\r\n        modifiedNote: null,\r\n        modifiedMidiClip: null,\r\n        isImported: false,\r\n      };\r\n\r\n    case \"DELETE_TRACK\":\r\n      const trackToDeleteIndex = state.tracks.findIndex(\r\n        (track) => track.dataKey === action.trackIndex\r\n      );\r\n\r\n      return {\r\n        tracks: [\r\n          ...state.tracks.slice(0, trackToDeleteIndex),\r\n          ...state.tracks.slice(trackToDeleteIndex + 1).map((track) => {\r\n            return {\r\n              ...track,\r\n              dataKey: track.dataKey - 1,\r\n              midiClips: track.midiClips.map((midiClip) => {\r\n                return {\r\n                  ...midiClip,\r\n                  trackKey: midiClip.trackKey - 1,\r\n                };\r\n              }),\r\n            };\r\n          }),\r\n        ],\r\n        modifiedNote: null,\r\n        modifiedMidiClip: null,\r\n        isImported: false,\r\n      };\r\n\r\n    case \"CHANGE_TRACK_PROPS\":\r\n      if (action.newTrackProps === undefined) {\r\n        throw Error(\"NewTrackProps is missing when editing track\");\r\n      }\r\n\r\n      const trackToChangeIndex = state.tracks.findIndex(\r\n        (track) => track.dataKey === action.trackIndex\r\n      );\r\n\r\n      const hasInstrumentChanged =\r\n        state.tracks[trackToChangeIndex].instrument !==\r\n        action.newTrackProps.instrument;\r\n\r\n      return {\r\n        tracks: [\r\n          ...state.tracks.slice(0, trackToChangeIndex),\r\n          {\r\n            ...state.tracks[trackToChangeIndex],\r\n            name: action.newTrackProps.name,\r\n            // color: action.newTrackProps.color,\r\n            instrument: hasInstrumentChanged\r\n              ? action.newTrackProps.instrument\r\n              : state.tracks[trackToChangeIndex].instrument,\r\n          },\r\n          ...state.tracks.slice(trackToChangeIndex + 1),\r\n        ],\r\n        modifiedNote: null,\r\n        modifiedMidiClip: null,\r\n        isImported: false,\r\n      };\r\n\r\n    case \"CLEAR_MODIFY_NOTE\":\r\n      return {\r\n        ...state,\r\n        modifiedNote: null,\r\n      };\r\n\r\n    case \"CLEAR_MODIFY_MIDICLIP\":\r\n      return {\r\n        ...state,\r\n        modifiedMidiClip: null,\r\n      };\r\n\r\n    case \"ADD_MIDI_CLIP\":\r\n      if (action.modifyMidiClip === null) {\r\n        throw Error(\"ModifyMidiClip is missing\");\r\n      }\r\n\r\n      if (action.modifyMidiClip!.newMidiClipProps === null) {\r\n        throw Error(\"NewMidiClipProps is missing\");\r\n      }\r\n\r\n      // If the new MIDI clip collides with an other existing one, cancel the action\r\n      if (\r\n        isMidiClipColliding(\r\n          action.modifyMidiClip!.newMidiClipProps!,\r\n          state.tracks[action.trackIndex].midiClips\r\n        )\r\n      ) {\r\n        //alert(\"!!!!COLLIDING_ADD\");\r\n        return state;\r\n      }\r\n\r\n      const addedMidis = [\r\n        ...state.tracks[action.trackIndex].midiClips,\r\n        action.modifyMidiClip!.newMidiClipProps,\r\n      ];\r\n\r\n      return {\r\n        tracks: [\r\n          ...state.tracks.slice(0, action.trackIndex),\r\n          {\r\n            ...state.tracks[action.trackIndex],\r\n            midiClips: addedMidis,\r\n          },\r\n          ...state.tracks.slice(action.trackIndex + 1),\r\n        ],\r\n        modifiedNote: null,\r\n        modifiedMidiClip: action.modifyMidiClip,\r\n        isImported: false,\r\n      };\r\n\r\n    case \"DELETE_MIDI_CLIP\":\r\n      if (action.modifyMidiClip === null) {\r\n        throw Error(\"ModifyMidiClip is missing\");\r\n      }\r\n\r\n      const midiClipToDeleteIndex = state.tracks[\r\n        action.trackIndex\r\n      ].midiClips.findIndex(\r\n        (item) => item.dataKey === action.modifyMidiClip!.midiClipDataKey\r\n      );\r\n\r\n      return {\r\n        tracks: [\r\n          ...state.tracks.slice(0, action.trackIndex),\r\n          {\r\n            ...state.tracks[action.trackIndex],\r\n            midiClips: [\r\n              ...state.tracks[action.trackIndex].midiClips.slice(\r\n                0,\r\n                midiClipToDeleteIndex\r\n              ),\r\n              ...state.tracks[action.trackIndex].midiClips.slice(\r\n                midiClipToDeleteIndex + 1\r\n              ),\r\n            ],\r\n          },\r\n          ...state.tracks.slice(action.trackIndex + 1),\r\n        ],\r\n        modifiedNote: null,\r\n        modifiedMidiClip: action.modifyMidiClip,\r\n        isImported: false,\r\n      };\r\n\r\n    case \"UPDATE_MIDI_CLIP\":\r\n      if (action.modifyMidiClip === null) {\r\n        throw Error(\"ModifyMidiClip is missing\");\r\n      }\r\n\r\n      if (action.modifyMidiClip!.newMidiClipProps === null) {\r\n        throw Error(\"NewMidiClipProps is missing\");\r\n      }\r\n\r\n      const midiClipToUpdateIndex = state.tracks[\r\n        action.trackIndex\r\n      ].midiClips.findIndex(\r\n        (item) => item.dataKey === action.modifyMidiClip!.midiClipDataKey\r\n      );\r\n\r\n      // Check if trackKey has changed\r\n      if (\r\n        action.modifyMidiClip!.trackDataKey ===\r\n        action.modifyMidiClip!.newMidiClipProps!.trackKey\r\n      ) {\r\n        // In this case it has NOT\r\n\r\n        // If the new MIDI clip collides with an other existing one, cancel the action\r\n        if (\r\n          isMidiClipColliding(\r\n            action.modifyMidiClip!.newMidiClipProps!,\r\n            state.tracks[action.trackIndex].midiClips\r\n          )\r\n        ) {\r\n          //alert(\"!!!!COLLIDING_UPDATE_SAME\");\r\n          return state;\r\n        }\r\n\r\n        const updatedMidiClip = [\r\n          ...state.tracks[action.trackIndex].midiClips.slice(\r\n            0,\r\n            midiClipToUpdateIndex\r\n          ),\r\n          {\r\n            ...state.tracks[action.trackIndex].midiClips[midiClipToUpdateIndex],\r\n            trackKey: action.modifyMidiClip!.newMidiClipProps!.trackKey,\r\n            startTime: action.modifyMidiClip!.newMidiClipProps!.startTime,\r\n            length: action.modifyMidiClip!.newMidiClipProps!.length,\r\n          },\r\n          ...state.tracks[action.trackIndex].midiClips.slice(\r\n            midiClipToUpdateIndex + 1\r\n          ),\r\n        ];\r\n\r\n        return {\r\n          tracks: [\r\n            ...state.tracks.slice(0, action.trackIndex),\r\n            {\r\n              ...state.tracks[action.trackIndex],\r\n              midiClips: updatedMidiClip,\r\n            },\r\n            ...state.tracks.slice(action.trackIndex + 1),\r\n          ],\r\n          modifiedNote: null,\r\n          modifiedMidiClip: action.modifyMidiClip, //notes will be empty here, no need them to be passed\r\n          isImported: false,\r\n        };\r\n      } else {\r\n        // TrackKey has changed in this case\r\n\r\n        // If the new MIDI clip collides with an other existing one, cancel the action\r\n        if (\r\n          isMidiClipColliding(\r\n            action.modifyMidiClip!.newMidiClipProps!,\r\n            state.tracks[action.modifyMidiClip!.newMidiClipProps!.trackKey]\r\n              .midiClips\r\n          )\r\n        ) {\r\n          //alert(\"!!!!COLLIDING_UPDATE_DIFFERENT\");\r\n          return state;\r\n        }\r\n\r\n        // First, we need to check, if the old track's instrument was PolySynth, and the new\r\n        // one is not. This is forbidden, because only PolySynth can play multiple notes at\r\n        // the same time. Therefore to prevent any errors, we have to enforce this rule.\r\n        const prevInstrument =\r\n          state.tracks[action.modifyMidiClip!.trackDataKey].instrument;\r\n        const newInstrument =\r\n          state.tracks[action.modifyMidiClip!.newMidiClipProps!.trackKey]\r\n            .instrument;\r\n\r\n        if (prevInstrument === \"PolySynth\" && newInstrument !== \"PolySynth\") {\r\n          window.alert(\r\n            \"Nem húzható át MIDI clip olyan sávról, amin PolySynth van, csak egy másik PolySynth-es sávra!\"\r\n          );\r\n\r\n          return state;\r\n        }\r\n\r\n        if (prevInstrument !== \"PolySynth\" && newInstrument === \"PolySynth\") {\r\n          if (\r\n            !window.confirm(\r\n              \"Biztosan át szeretnéd húzni ezt a MIDI clippet egy PolySynthes sávra? Utána már csak PolySynthes sávokra lesz húzható a MIDI clip!\"\r\n            )\r\n          ) {\r\n            return state;\r\n          }\r\n        }\r\n\r\n        const newTracks = state.tracks.slice();\r\n\r\n        // Make a copy of the midiClip that needs to be moved\r\n        const midiClipToCopy =\r\n          state.tracks[action.trackIndex].midiClips[midiClipToUpdateIndex];\r\n\r\n        // TrackKey has changed, so delete midiClip from old track\r\n        newTracks[action.trackIndex].midiClips = [\r\n          ...newTracks[action.trackIndex].midiClips.slice(\r\n            0,\r\n            midiClipToUpdateIndex\r\n          ),\r\n          ...newTracks[action.trackIndex].midiClips.slice(\r\n            midiClipToUpdateIndex + 1\r\n          ),\r\n        ];\r\n\r\n        // And insert it in the new track\r\n        newTracks[action.modifyMidiClip!.newMidiClipProps!.trackKey].midiClips =\r\n          [\r\n            ...newTracks[action.modifyMidiClip!.newMidiClipProps!.trackKey]\r\n              .midiClips,\r\n            {\r\n              dataKey: midiClipToCopy.dataKey,\r\n              notes: midiClipToCopy.notes,\r\n              length: midiClipToCopy.length,\r\n              startTime: action.modifyMidiClip!.newMidiClipProps!.startTime,\r\n              trackKey: action.modifyMidiClip!.newMidiClipProps!.trackKey,\r\n            },\r\n          ];\r\n\r\n        return {\r\n          tracks: newTracks,\r\n          isImported: false,\r\n          modifiedNote: null,\r\n          modifiedMidiClip: {\r\n            ...action.modifyMidiClip!,\r\n            newMidiClipProps: {\r\n              ...action.modifyMidiClip!.newMidiClipProps,\r\n              notes: midiClipToCopy.notes,\r\n              // Here we need to pass the notes, so the new track can create the new part\r\n            },\r\n            oldTrackInstrumentName:\r\n              newTracks[midiClipToCopy.trackKey].instrument,\r\n          }, // Pass the prev track's instrument name, so we can enforce the no PolySynth\r\n          // to not PolySynth rule\r\n        };\r\n      }\r\n\r\n    case \"ADD_NOTE\":\r\n      if (action.modifyNote === undefined) {\r\n        throw Error(\"ModifyNote is missing\");\r\n      }\r\n\r\n      if (action.modifyNote.newNoteProps === undefined) {\r\n        throw Error(\"NewNoteProps is missing\");\r\n      }\r\n\r\n      const midiClipIndexAdd = state.tracks[\r\n        action.trackIndex\r\n      ].midiClips.findIndex(\r\n        (item) => item.dataKey === action.modifyNote!.midiClipDataKey\r\n      );\r\n\r\n      if (\r\n        state.tracks[action.trackIndex].instrument !== \"PolySynth\" &&\r\n        isAllowed(\r\n          action.modifyNote!.newNoteProps!,\r\n          state.tracks[action.trackIndex].midiClips[midiClipIndexAdd].notes\r\n        )\r\n      ) {\r\n        alert(\"Csak a PolySynth tud egyszerre több hangot is lejátszani!\");\r\n        return state;\r\n      }\r\n\r\n      if (\r\n        isMidiNoteColliding(\r\n          action.modifyNote.newNoteProps,\r\n          state.tracks[action.trackIndex].midiClips[midiClipIndexAdd].notes\r\n        )\r\n      ) {\r\n        // alert(\"MIDI_NOTE_COLLISION_ADD\");\r\n        return state;\r\n      }\r\n\r\n      const addedNotesMidiClip = [\r\n        ...state.tracks[action.trackIndex].midiClips.slice(0, midiClipIndexAdd),\r\n        {\r\n          ...state.tracks[action.trackIndex].midiClips[midiClipIndexAdd],\r\n          notes: [\r\n            ...state.tracks[action.trackIndex].midiClips[midiClipIndexAdd]\r\n              .notes,\r\n            {\r\n              dataKey: action.modifyNote.newNoteProps.dataKey,\r\n              startTime: action.modifyNote.newNoteProps.startTime,\r\n              length: action.modifyNote.newNoteProps.length,\r\n              note: action.modifyNote.newNoteProps.note,\r\n            },\r\n          ],\r\n        },\r\n        ...state.tracks[action.trackIndex].midiClips.slice(\r\n          midiClipIndexAdd + 1\r\n        ),\r\n      ];\r\n\r\n      return {\r\n        tracks: [\r\n          ...state.tracks.slice(0, action.trackIndex),\r\n          {\r\n            ...state.tracks[action.trackIndex],\r\n            midiClips: addedNotesMidiClip,\r\n          },\r\n          ...state.tracks.slice(action.trackIndex + 1),\r\n        ],\r\n        modifiedNote: action.modifyNote,\r\n        modifiedMidiClip: null,\r\n        isImported: false,\r\n      };\r\n\r\n    case \"DELETE_NOTE\":\r\n      if (action.modifyNote === undefined) {\r\n        throw Error(\"ModifyNote is missing\");\r\n      }\r\n\r\n      const midiClipIndexDelete = state.tracks[\r\n        action.trackIndex\r\n      ].midiClips.findIndex(\r\n        (item) => item.dataKey === action.modifyNote!.midiClipDataKey\r\n      );\r\n\r\n      const noteToDeleteIndex = state.tracks[action.trackIndex].midiClips[\r\n        midiClipIndexDelete\r\n      ].notes.findIndex(\r\n        (item) => item.dataKey === action.modifyNote!.noteDataKey\r\n      );\r\n\r\n      const deletedNotesMidiClip = [\r\n        ...state.tracks[action.trackIndex].midiClips.slice(\r\n          0,\r\n          midiClipIndexDelete\r\n        ),\r\n        {\r\n          ...state.tracks[action.trackIndex].midiClips[midiClipIndexDelete],\r\n          notes: [\r\n            ...state.tracks[action.trackIndex].midiClips[\r\n              midiClipIndexDelete\r\n            ].notes.slice(0, noteToDeleteIndex),\r\n            ...state.tracks[action.trackIndex].midiClips[\r\n              midiClipIndexDelete\r\n            ].notes.slice(noteToDeleteIndex + 1),\r\n          ],\r\n        },\r\n        ...state.tracks[action.trackIndex].midiClips.slice(\r\n          midiClipIndexDelete + 1\r\n        ),\r\n      ];\r\n\r\n      return {\r\n        tracks: [\r\n          ...state.tracks.slice(0, action.trackIndex),\r\n          {\r\n            ...state.tracks[action.trackIndex],\r\n            midiClips: deletedNotesMidiClip,\r\n          },\r\n          ...state.tracks.slice(action.trackIndex + 1),\r\n        ],\r\n        modifiedNote: action.modifyNote,\r\n        modifiedMidiClip: null,\r\n        isImported: false,\r\n      };\r\n\r\n    case \"UPDATE_NOTE\":\r\n      if (action.modifyNote === undefined) {\r\n        throw Error(\"ModifyNote is missing\");\r\n      }\r\n\r\n      if (action.modifyNote.newNoteProps === undefined) {\r\n        throw Error(\"NewNoteProps is missing\");\r\n      }\r\n\r\n      const midiClipIndexUpdate = state.tracks[\r\n        action.trackIndex\r\n      ].midiClips.findIndex(\r\n        (item) => item.dataKey === action.modifyNote!.midiClipDataKey\r\n      );\r\n\r\n      if (\r\n        state.tracks[action.trackIndex].instrument !== \"PolySynth\" &&\r\n        isAllowed(\r\n          action.modifyNote!.newNoteProps!,\r\n          state.tracks[action.trackIndex].midiClips[midiClipIndexUpdate].notes\r\n        )\r\n      ) {\r\n        alert(\"Csak a PolySynth tud egyszerre több hangot is lejátszani!\");\r\n        return state;\r\n      }\r\n\r\n      const noteToUpdateIndex = state.tracks[action.trackIndex].midiClips[\r\n        midiClipIndexUpdate\r\n      ].notes.findIndex(\r\n        (item) => item.dataKey === action.modifyNote!.noteDataKey\r\n      );\r\n\r\n      if (\r\n        isMidiNoteColliding(\r\n          action.modifyNote.newNoteProps,\r\n          state.tracks[action.trackIndex].midiClips[midiClipIndexUpdate].notes\r\n        )\r\n      ) {\r\n        // alert(\"MIDI_NOTE_COLLISION_UPDATE\");\r\n        return state;\r\n      }\r\n\r\n      const updatedNotesMidiClip = [\r\n        ...state.tracks[action.trackIndex].midiClips.slice(\r\n          0,\r\n          midiClipIndexUpdate\r\n        ),\r\n        {\r\n          ...state.tracks[action.trackIndex].midiClips[midiClipIndexUpdate],\r\n          notes: [\r\n            ...state.tracks[action.trackIndex].midiClips[\r\n              midiClipIndexUpdate\r\n            ].notes.slice(0, noteToUpdateIndex),\r\n            {\r\n              dataKey: action.modifyNote.noteDataKey,\r\n              startTime: action.modifyNote.newNoteProps.startTime,\r\n              length: action.modifyNote.newNoteProps.length,\r\n              note: action.modifyNote.newNoteProps.note,\r\n            },\r\n            ...state.tracks[action.trackIndex].midiClips[\r\n              midiClipIndexUpdate\r\n            ].notes.slice(noteToUpdateIndex + 1),\r\n          ],\r\n        },\r\n        ...state.tracks[action.trackIndex].midiClips.slice(\r\n          midiClipIndexUpdate + 1\r\n        ),\r\n      ];\r\n\r\n      return {\r\n        tracks: [\r\n          ...state.tracks.slice(0, action.trackIndex),\r\n          {\r\n            ...state.tracks[action.trackIndex],\r\n            midiClips: updatedNotesMidiClip,\r\n          },\r\n          ...state.tracks.slice(action.trackIndex + 1),\r\n        ],\r\n        modifiedNote: action.modifyNote,\r\n        modifiedMidiClip: null,\r\n        isImported: false,\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default CurTracksReducer;\r\n","const SelectedMidiClipReducer = (\r\n  state: {\r\n    trackKey: number;\r\n    midiClipDataKey: number;\r\n  } | null = null,\r\n  action: {\r\n    type: string;\r\n    payload: { trackKey: number; midiClipDataKey: number };\r\n  }\r\n) => {\r\n  switch (action.type) {\r\n    case \"SELECT_MIDI_CLIP\":\r\n      return action.payload;\r\n    case \"DESELECT_MIDI_CLIP\":\r\n      return null;\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default SelectedMidiClipReducer;\r\n","import { ArrCanvasProps } from \"../Interfaces\";\r\n\r\nconst ArrCanvasPropsReducer = (\r\n  state: ArrCanvasProps = {\r\n    numOfPhrases: 4,\r\n    gridPadding: 16,\r\n    midiClipColor: \"grey\",\r\n  },\r\n  action: {\r\n    type: string;\r\n    payload: number | string;\r\n  }\r\n) => {\r\n  switch (action.type) {\r\n    case \"CHANGE_ARR_VIEW_NUM_OF_PHRASES\":\r\n      return {\r\n        ...state,\r\n        numOfPhrases: action.payload,\r\n      };\r\n\r\n    case \"CHANGE_ARR_VIEW_GRID_PADDING\":\r\n      return {\r\n        ...state,\r\n        gridPadding: action.payload,\r\n      };\r\n\r\n    case \"CHANGE_MIDI_CLIP_COLOR\":\r\n      return {\r\n        ...state,\r\n        midiClipColor: action.payload,\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default ArrCanvasPropsReducer;\r\n","import { PianoRollCanvasProps } from \"../Interfaces\";\r\n\r\nconst PianoRollCanvasPropsReducer = (\r\n  state: PianoRollCanvasProps = {\r\n    gridPadding: 16,\r\n    midiNoteColor: \"#6fff00\",\r\n  },\r\n  action: {\r\n    type: string;\r\n    payload: number | string;\r\n  }\r\n) => {\r\n  switch (action.type) {\r\n    case \"CHANGE_PIANO_ROLL_VIEW_GRID_PADDING\":\r\n      return {\r\n        ...state,\r\n        gridPadding: action.payload,\r\n      };\r\n\r\n    case \"CHANGE_MIDI_NOTE_COLOR\":\r\n      return {\r\n        ...state,\r\n        midiNoteColor: action.payload,\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default PianoRollCanvasPropsReducer;\r\n","const CurTransportPositionReducer = (\r\n  state: number = 0,\r\n  action: {\r\n    type: string;\r\n    payload: number;\r\n  }\r\n) => {\r\n  switch (action.type) {\r\n    case \"SET_CUR_TRANSPORT_POSITION\":\r\n      return action.payload;\r\n\r\n    case \"CLEAR_SPACE_EVENT\":\r\n      document.onkeydown = null;\r\n      return state;\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default CurTransportPositionReducer;\r\n","const ClearTrackReducer = (\r\n  state: boolean = false,\r\n  action: {\r\n    type: string;\r\n    payload: boolean;\r\n  }\r\n) => {\r\n  switch (action.type) {\r\n    case \"CLEAR_EVERY_TRACK\":\r\n      return true;\r\n\r\n    case \"TRACKS_CLEARED\":\r\n      return false;\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default ClearTrackReducer;\r\n","const ImportPropsReducer = (\r\n  state: {\r\n    BPM: number;\r\n  } = {\r\n    BPM: -1,\r\n  },\r\n  action: {\r\n    type: string;\r\n    payload: number;\r\n  }\r\n) => {\r\n  switch (action.type) {\r\n    case \"SET_IMPORTED_BPM\":\r\n      return {\r\n        ...state,\r\n        BPM: action.payload,\r\n      };\r\n\r\n    case \"CLEAR_IMPORTED_BPM\":\r\n      return {\r\n        ...state,\r\n        BPM: -1,\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default ImportPropsReducer;\r\n","import { combineReducers } from \"redux\";\r\nimport CurTracksReducer from \"./CurTracksReducer\";\r\nimport SelectedMidiClipReducer from \"./SelectedMidiClipReducer\";\r\nimport ArrCanvasPropsReducer from \"./ArrCanvasPropsReducer\";\r\nimport PianoRollCanvasPropsReducer from \"./PianoRollCanvasPropsReducer\";\r\nimport CurTransportPositionReducer from \"./CurTransportPositionReducer\";\r\nimport ClearTrackReducer from \"./ClearTrackReducer\";\r\nimport ImportPropsReducer from \"./ImportPropsReducer\";\r\n\r\nconst allReducers = combineReducers({\r\n  curTracks: CurTracksReducer,\r\n  selectedMidiClip: SelectedMidiClipReducer,\r\n  arrCanvasProps: ArrCanvasPropsReducer,\r\n  pianoRollCanvasProps: PianoRollCanvasPropsReducer,\r\n  curTransportPosition: CurTransportPositionReducer,\r\n  disposeTracks: ClearTrackReducer,\r\n  importedProps: ImportPropsReducer,\r\n});\r\n\r\nexport default allReducers;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport App from \"./App\";\r\nimport reportWebVitals from \"./reportWebVitals\";\r\nimport allReducer from \"./AppComponents/Reducers\";\r\nimport { createStore } from \"redux\";\r\nimport { Provider } from \"react-redux\";\r\nimport * as Tone from \"tone\";\r\n\r\nconst store = createStore(allReducer);\r\nTone.Transport.PPQ = 192;\r\n\r\n//Tone.setContext(new Tone.Context({ latencyHint : \"balanced\" }))\r\n\r\n// document.onkeydown = (e) => {e.stopPropagation()}\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <App />\r\n  </Provider>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}